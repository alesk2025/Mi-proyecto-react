{"ast":null,"code":"import _objectSpread from\"C:/Users/User/Downloads/project (10)/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{classifyAnimalAge}from'../utils/helpers';// Importar la función de utilidad\nimport{exportToCsv,exportTableToPdf}from'../utils/exportHelpers';// Importar funciones de exportación\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const GESTATION_DAYS=283;// Días promedio de gestación para bovinos\nconst ReproductiveControlPage=_ref=>{let{animals,onUpdateAnimalProduction,onRegisterReproductiveEvent,onDeletePregnantCow,reproductiveRecords,setReproductiveRecords,onRegisterAnimal,currentUser,logoUrl}=_ref;const[currentSection,setCurrentSection]=useState('montaNatural');// 'montaNatural', 'inseminacion', 'gestacion', 'historial'\nconst[montaNaturalData,setMontaNaturalData]=useState({vacaId:'',toroId:'',fechaMonta:'',observaciones:''});const[inseminacionData,setInseminacionData]=useState({vacaId:'',semenId:'',// ID del semen utilizado\nfechaInseminacion:'',inseminador:'',observaciones:''});const[gestacionData,setGestacionData]=useState({vacaId:'',fechaDiagnostico:'',resultadoDiagnostico:'',// 'positiva', 'negativa'\nfechaPartoEstimada:'',// Calculada\nfechaPartoReal:'',pesoTernero:'',sexoTernero:'',nombreTernero:'',observacionesParto:'',padreTerneroId:'',// ID del padre si está registrado\npadreTerneroNombre:'',// Nombre del padre si es nuevo\nrazaPadreTernero:'',// Raza del padre si es nuevo\nisPadreRegistered:false// Para controlar si el padre está registrado\n});const[editingRecord,setEditingRecord]=useState(null);// To hold the record being edited\nconst historyTableRef=useRef(null);// Ref for the history table\nconst[filterStartDate,setFilterStartDate]=useState('');const[filterEndDate,setFilterEndDate]=useState('');// Función auxiliar para calcular días restantes\nconst calcularDiasRestantes=fechaPartoEstimada=>{const hoy=new Date();const fecha=new Date(fechaPartoEstimada);// Verificar si la fecha es válida antes de calcular la diferencia\nif(isNaN(fecha.getTime())){return NaN;// Retorna NaN si la fecha no es válida\n}const diferencia=fecha.getTime()-hoy.getTime();// Usar getTime() para operar con milisegundos\nreturn Math.ceil(diferencia/(1000*60*60*24));};// useEffect para evaluar registros reproductivos y actualizar estados\nuseEffect(()=>{if(!reproductiveRecords||reproductiveRecords.length===0){return;}let animalStatusUpdates=[];let recordStatusUpdates=[];reproductiveRecords.forEach(record=>{const currentAnimal=animals.find(a=>a.id===record.idAnimal);if(!currentAnimal)return;// Animal not found, skip\n// Logic for 'preñada' records that are not yet finalized\nif(record.tipoEvento==='diagnóstico'&&record.estadoPosterior==='preñada'&&record.estado!=='finalizado'){let estimatedBirthDateStr=record.fechaPartoEstimada;// If estimated birth date is missing, calculate it from the diagnosis date\nif(!estimatedBirthDateStr){const diagnosisDate=new Date(record.fechaEvento);if(diagnosisDate instanceof Date&&!isNaN(diagnosisDate.getTime())){const estimatedDate=new Date(diagnosisDate);estimatedDate.setDate(estimatedDate.getDate()+GESTATION_DAYS);estimatedBirthDateStr=estimatedDate.toISOString().split('T')[0];// Update the record itself with the estimated date for persistence\nrecordStatusUpdates.push({id:record.id,update:{fechaPartoEstimada:estimatedBirthDateStr}});}}if(estimatedBirthDateStr){const dias=calcularDiasRestantes(estimatedBirthDateStr);// Solo aplicar reglas si los días restantes son un número válido\nif(!isNaN(dias)){// Rule 1: Change to SECA if less than 100 days to birth AND animal is not already 'seca'\nif(dias<=100&&dias>0&&currentAnimal.estadoReproductivo!=='seca'){animalStatusUpdates.push({id:record.idAnimal,update:{estadoReproductivo:'seca'}});}// Rule 2: Change to PRODUCCIÓN if estimated birth date passed AND animal is not already 'produccion'\nif(dias<=0&&currentAnimal.estadoReproductivo!=='produccion'){animalStatusUpdates.push({id:record.idAnimal,update:{estadoReproductivo:'produccion',fechaUltimoParto:estimatedBirthDateStr}});// Mark the reproductive record as finalized after birth\nrecordStatusUpdates.push({id:record.id,update:{estado:'finalizado'}});}}}}});// Apply animal status updates\nanimalStatusUpdates.forEach(update=>{onUpdateAnimalProduction(update.id,update.update);});// Apply reproductive record status updates\nif(recordStatusUpdates.length>0){const newReproductiveRecords=reproductiveRecords.map(rec=>{const update=recordStatusUpdates.find(u=>u.id===rec.id);return update?_objectSpread(_objectSpread({},rec),update.update):rec;});setReproductiveRecords(newReproductiveRecords);}},[reproductiveRecords,animals,onUpdateAnimalProduction,setReproductiveRecords]);// Dependencies\nconst handleMontaNaturalChange=e=>{const{name,value}=e.target;setMontaNaturalData(_objectSpread(_objectSpread({},montaNaturalData),{},{[name]:value}));};const handleInseminacionChange=e=>{const{name,value}=e.target;setInseminacionData(_objectSpread(_objectSpread({},inseminacionData),{},{[name]:value}));};const handleGestacionChange=e=>{const{name,value,type,checked}=e.target;let updatedGestacionData=_objectSpread(_objectSpread({},gestacionData),{},{[name]:value});if(type==='checkbox'){updatedGestacionData=_objectSpread(_objectSpread({},gestacionData),{},{[name]:checked});}else if(name==='fechaDiagnostico'&&updatedGestacionData.resultadoDiagnostico==='positiva'){// Recalcular fechaPartoEstimada si cambia la fechaDiagnostico y el resultado es positivo\nconst diagnosisDateObj=new Date(value);if(diagnosisDateObj instanceof Date&&!isNaN(diagnosisDateObj.getTime())){const estimatedDate=new Date(diagnosisDateObj);estimatedDate.setDate(estimatedDate.getDate()+GESTATION_DAYS);updatedGestacionData.fechaPartoEstimada=estimatedDate.toISOString().split('T')[0];}else{updatedGestacionData.fechaPartoEstimada='';}}else if(name==='resultadoDiagnostico'&&value==='positiva'&&updatedGestacionData.fechaDiagnostico){// Recalcular fechaPartoEstimada si el resultado cambia a positivo y ya hay fechaDiagnostico\nconst diagnosisDateObj=new Date(updatedGestacionData.fechaDiagnostico);if(diagnosisDateObj instanceof Date&&!isNaN(diagnosisDateObj.getTime())){const estimatedDate=new Date(diagnosisDateObj);estimatedDate.setDate(estimatedDate.getDate()+GESTATION_DAYS);updatedGestacionData.fechaPartoEstimada=estimatedDate.toISOString().split('T')[0];}else{updatedGestacionData.fechaPartoEstimada='';}}else if(name==='resultadoDiagnostico'&&value==='negativa'){// Limpiar fechaPartoEstimada si el resultado es negativo\nupdatedGestacionData.fechaPartoEstimada='';}setGestacionData(updatedGestacionData);};const handleMontaNaturalSubmit=()=>{const{vacaId,toroId,fechaMonta,observaciones}=montaNaturalData;if(!vacaId||!toroId||!fechaMonta){alert('¡Ups! Parece que te faltan algunos datos para registrar la monta natural. ¡Completa todos los campos y lo intentamos de nuevo!');return;}// Calcular fecha de parto estimada para el registro\nconst montaDateObj=new Date(fechaMonta);let estimatedBirthDateForRecord='';if(montaDateObj instanceof Date&&!isNaN(montaDateObj.getTime())){const estimatedDate=new Date(montaDateObj);estimatedDate.setDate(estimatedDate.getDate()+GESTATION_DAYS);estimatedBirthDateForRecord=estimatedDate.toISOString().split('T')[0];}onRegisterReproductiveEvent({id:\"REC-\".concat(Date.now().toString().slice(-5)),// Generar ID único\nidAnimal:vacaId,tipoEvento:'monta',fechaEvento:fechaMonta,observaciones,estadoPosterior:'posiblemente preñada',// Estado inicial después de monta/inseminación\ntoroId,fechaPartoEstimada:estimatedBirthDateForRecord// Guardar fecha de parto estimada\n});alert('¡Excelente! La monta natural ha sido registrada con éxito. ¡Esperemos que pronto tengamos buenas noticias!');setMontaNaturalData({vacaId:'',toroId:'',fechaMonta:'',observaciones:''});};const handleInseminacionSubmit=()=>{const{vacaId,semenId,fechaInseminacion,observaciones}=inseminacionData;if(!vacaId||!semenId||!fechaInseminacion){alert('¡Uy! Para registrar la inseminación, necesitamos que llenes todos los campos. ¡No te rindas, ya casi lo logras!');return;}// Calcular fecha de parto estimada para el registro\nconst inseminacionDateObj=new Date(fechaInseminacion);let estimatedBirthDateForRecord='';if(inseminacionDateObj instanceof Date&&!isNaN(inseminacionDateObj.getTime())){const estimatedDate=new Date(inseminacionDateObj);estimatedDate.setDate(estimatedDate.getDate()+GESTATION_DAYS);estimatedBirthDateForRecord=estimatedDate.toISOString().split('T')[0];}onRegisterReproductiveEvent({id:\"REC-\".concat(Date.now().toString().slice(-5)),// Generar ID único\nidAnimal:vacaId,tipoEvento:'inseminacion',fechaEvento:fechaInseminacion,observaciones,estadoPosterior:'posiblemente preñada',// Estado inicial después de monta/inseminación\ntoroId:semenId,// opcional\nfechaPartoEstimada:estimatedBirthDateForRecord// Guardar fecha de parto estimada\n});alert('¡Genial! La inseminación ha sido registrada. ¡Crucemos los dedos por un buen resultado!');setInseminacionData({vacaId:'',semenId:'',fechaInseminacion:'',observaciones:''});};const handleGestacionSubmit=()=>{const{vacaId,fechaDiagnostico,resultadoDiagnostico,pesoTernero,sexoTernero,nombreTernero,observacionesParto,fechaPartoReal,padreTerneroId,padreTerneroNombre,razaPadreTernero,isPadreRegistered,fechaPartoEstimada// Usar la fechaPartoEstimada del estado\n}=gestacionData;if(!vacaId||!fechaDiagnostico||!resultadoDiagnostico){alert('¡Atención! Para el diagnóstico de gestación, necesitamos que completes los campos obligatorios. ¡Vamos, tú puedes!');return;}let newAnimalState='';if(resultadoDiagnostico==='positiva'){newAnimalState='preñada';}else{newAnimalState='vacia';}// Actualizar el estado reproductivo de la vaca\nonUpdateAnimalProduction(vacaId,{estadoReproductivo:newAnimalState,fechaUltimaGestacion:newAnimalState==='preñada'?fechaDiagnostico:''});// Registrar el evento de diagnóstico\nonRegisterReproductiveEvent({id:\"REC-\".concat(Date.now().toString().slice(-5)),idAnimal:vacaId,tipoEvento:'diagnóstico',fechaEvento:fechaDiagnostico,observaciones:\"Diagn\\xF3stico: \".concat(resultadoDiagnostico,\". \").concat(observacionesParto),estadoPosterior:newAnimalState,fechaPartoEstimada:fechaPartoEstimada// Usar la fechaPartoEstimada del estado\n});// Si se registró una fecha de parto real\nif(fechaPartoReal){onUpdateAnimalProduction(vacaId,{estadoReproductivo:'produccion',fechaUltimoParto:fechaPartoReal});onRegisterReproductiveEvent({id:\"REC-\".concat(Date.now().toString().slice(-5)),idAnimal:vacaId,tipoEvento:'parto',fechaEvento:fechaPartoReal,observaciones:observacionesParto,estadoPosterior:'produccion'});if(nombreTernero&&sexoTernero&&pesoTernero){var _animals$find,_animals$find2;const birthYear=new Date(fechaPartoReal).getFullYear().toString().slice(-2);const newCalfId=\"\".concat(vacaId,\"-\").concat(birthYear);const newCalf={id:newCalfId,name:nombreTernero,raza:((_animals$find=animals.find(a=>a.id===vacaId))===null||_animals$find===void 0?void 0:_animals$find.raza)||'Desconocida',peso:pesoTernero,sexo:sexoTernero,fechaNacimiento:fechaPartoReal,fechaCompra:'',tipoProduccion:'',idpadre:isPadreRegistered?padreTerneroId:padreTerneroNombre,razaPadre:isPadreRegistered?((_animals$find2=animals.find(a=>a.id===padreTerneroId))===null||_animals$find2===void 0?void 0:_animals$find2.raza)||'Desconocida':razaPadreTernero,idmadre:vacaId,estadoReproductivo:'desarrollo',edadClasificada:classifyAnimalAge(fechaPartoReal,sexoTernero)};onRegisterAnimal(newCalf);alert(\"\\xA1Felicidades! El ternero \".concat(nombreTernero,\" ha sido registrado autom\\xE1ticamente con ID: \").concat(newCalfId,\". \\xA1Un nuevo miembro en la familia!\"));}}alert('¡Diagnóstico de gestación registrado! Mantente al tanto de las novedades.');setGestacionData({vacaId:'',fechaDiagnostico:'',resultadoDiagnostico:'',fechaPartoEstimada:'',pesoTernero:'',sexoTernero:'',nombreTernero:'',observacionesParto:'',fechaPartoReal:'',padreTerneroId:'',padreTerneroNombre:'',razaPadreTernero:'',isPadreRegistered:false});};const handleDeleteHistoryRecord=recordId=>{if(window.confirm('¿Estás seguro de que quieres eliminar este registro? ¡Esta acción no se puede deshacer!')){const updatedRecords=reproductiveRecords.filter(record=>record.id!==recordId);setReproductiveRecords(updatedRecords);// Update state in App.js via prop\nalert('¡Registro eliminado! Como si nunca hubiera existido.');}};const startEditingHistoryRecord=record=>{setEditingRecord(_objectSpread({},record));// Create a copy to edit\nalert('¡A editar se ha dicho! Modifica los campos y guarda los cambios.');};const handleEditingHistoryChange=e=>{const{name,value}=e.target;setEditingRecord(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const saveEditedHistoryRecord=()=>{const updatedRecords=reproductiveRecords.map(record=>record.id===editingRecord.id?editingRecord:record);setReproductiveRecords(updatedRecords);// Update state in App.js via prop\nsetEditingRecord(null);// Exit editing mode\nalert('¡Cambios guardados! Tu historial está al día.');};const cancelEditingHistoryRecord=()=>{setEditingRecord(null);// Exit editing mode\nalert('¡Edición cancelada! No te preocupes, tus datos están a salvo.');};// Function to add a manual reproductive event\nconst handleAddManualEvent=()=>{const animalId=prompt(\"Ingresa el ID del animal para el evento manual:\");const tipoEvento=prompt(\"¿Qué tipo de evento quieres registrar? (ej. 'observacion', 'tratamiento'):\");const fechaEvento=prompt(\"¿Cuándo ocurrió el evento? (YYYY-MM-DD):\");const observaciones=prompt(\"¿Alguna observación adicional sobre este evento?:\");const estadoPosterior=prompt(\"¿Cuál es el estado del animal después de este evento? (ej. 'vacia', 'produccion'):\");if(animalId&&tipoEvento&&fechaEvento){onRegisterReproductiveEvent({id:\"REC-\".concat(Date.now().toString().slice(-5)),// Generar ID único\nidAnimal:animalId,tipoEvento:tipoEvento,fechaEvento:fechaEvento,observaciones:observaciones,estadoPosterior:estadoPosterior});alert('¡Evento manual registrado! Tu historial sigue creciendo.');}else{alert('¡Ojo! Para registrar un evento manual, necesitamos el ID del animal, el tipo de evento y la fecha. ¡Inténtalo de nuevo!');}};const handleExportHistory=async format=>{if(reproductiveRecords.length===0){alert('¡No hay registros para exportar! ¿Qué esperas para empezar a registrar?');return;}const filename=\"historial_reproductivo_\".concat(new Date().toISOString().split('T')[0]);const farmName=(currentUser===null||currentUser===void 0?void 0:currentUser.farmName)||'Mi Finca Ganadera';const adminName=(currentUser===null||currentUser===void 0?void 0:currentUser.fullName)||'Administrador';if(format==='csv'){exportToCsv(reproductiveRecords,filename);alert('¡Exportando a CSV! Tu historial estará listo en un santiamén.');}else if(format==='pdf'){await exportTableToPdf(historyTableRef.current,filename,'Historial Reproductivo',farmName,adminName,logoUrl);alert('¡Generando PDF! Tu historial se verá de lujo en papel.');}};// Filtrar vacas preñadas para la tabla\nconst pregnantCows=animals.filter(animal=>animal.sexo==='hembra'&&animal.estadoReproductivo==='preñada').map(animal=>{// Encontrar el último registro de gestación positiva para obtener la fecha de parto estimada\nconst lastPositiveDiagnosis=reproductiveRecords.filter(rec=>rec.idAnimal===animal.id&&rec.tipoEvento==='diagnóstico'&&rec.estadoPosterior==='preñada').sort((a,b)=>new Date(b.fechaEvento)-new Date(a.fechaEvento))[0];const lastMontaInseminacion=reproductiveRecords.filter(rec=>rec.idAnimal===animal.id&&(rec.tipoEvento==='monta'||rec.tipoEvento==='inseminacion')).sort((a,b)=>new Date(b.fechaEvento)-new Date(a.fechaEvento))[0];let fechaOrigenGestacion='';let fechaPartoEstimada='';if(lastPositiveDiagnosis&&lastPositiveDiagnosis.fechaPartoEstimada){fechaOrigenGestacion=lastPositiveDiagnosis.fechaEvento;fechaPartoEstimada=lastPositiveDiagnosis.fechaPartoEstimada;}else if(lastMontaInseminacion){fechaOrigenGestacion=lastMontaInseminacion.fechaEvento;const origenDateObj=new Date(fechaOrigenGestacion);if(origenDateObj instanceof Date&&!isNaN(origenDateObj.getTime())){const estimatedDate=new Date(origenDateObj);estimatedDate.setDate(estimatedDate.getDate()+GESTATION_DAYS);fechaPartoEstimada=estimatedDate.toISOString().split('T')[0];}}return _objectSpread(_objectSpread({},animal),{},{fechaOrigenGestacion:fechaOrigenGestacion,fechaPartoEstimada:fechaPartoEstimada});}).filter(animal=>animal.fechaPartoEstimada);// Solo incluir vacas con fecha de parto estimada\nconst filteredReproductiveRecords=reproductiveRecords.filter(record=>{const recordDate=new Date(record.fechaEvento);const start=filterStartDate?new Date(filterStartDate):null;const end=filterEndDate?new Date(filterEndDate):null;if(start&&recordDate<start)return false;if(end&&recordDate>end)return false;return true;});const maleAnimals=animals.filter(a=>a.sexo==='macho');return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-4\",children:\"Control Reproductivo\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center mb-6 space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentSection('montaNatural'),className:\"px-6 py-2 rounded-lg \".concat(currentSection==='montaNatural'?'bg-blue-600 text-white':'bg-gray-200 text-gray-800',\" hover:bg-blue-700 transition-colors\"),children:\"Monta Natural\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentSection('inseminacion'),className:\"px-6 py-2 rounded-lg \".concat(currentSection==='inseminacion'?'bg-blue-600 text-white':'bg-gray-200 text-gray-800',\" hover:bg-blue-700 transition-colors\"),children:\"Inseminaci\\xF3n\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentSection('gestacion'),className:\"px-6 py-2 rounded-lg \".concat(currentSection==='gestacion'?'bg-blue-600 text-white':'bg-gray-200 text-gray-800',\" hover:bg-blue-700 transition-colors\"),children:\"Control de Gestaci\\xF3n / Parto\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentSection('historial'),className:\"px-6 py-2 rounded-lg \".concat(currentSection==='historial'?'bg-blue-600 text-white':'bg-gray-200 text-gray-800',\" hover:bg-blue-700 transition-colors\"),children:\"Historial Reproductivo\"})]}),currentSection==='montaNatural'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border rounded-lg bg-gray-50\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold mb-3\",children:\"Registro de Monta Natural\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Vaca:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"vacaId\",className:\"w-full px-4 py-2 border rounded-lg\",value:montaNaturalData.vacaId,onChange:handleMontaNaturalChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona Vaca\"}),animals.filter(a=>a.sexo==='hembra').map(vaca=>/*#__PURE__*/_jsxs(\"option\",{value:vaca.id,children:[vaca.name,\" (\",vaca.id,\")\"]},vaca.id))]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Toro:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"toroId\",className:\"w-full px-4 py-2 border rounded-lg\",value:montaNaturalData.toroId,onChange:handleMontaNaturalChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona Toro\"}),animals.filter(a=>a.sexo==='macho').map(toro=>/*#__PURE__*/_jsxs(\"option\",{value:toro.id,children:[toro.name,\" (\",toro.id,\")\"]},toro.id))]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Fecha de Monta:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaMonta\",placeholder:\"Fecha de Monta\",className:\"w-full px-4 py-2 border rounded-lg\",value:montaNaturalData.fechaMonta,onChange:handleMontaNaturalChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1 col-span-full\",children:\"Observaciones:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"observaciones\",placeholder:\"Observaciones\",rows:\"2\",className:\"w-full px-4 py-2 border rounded-lg col-span-full\",value:montaNaturalData.observaciones,onChange:handleMontaNaturalChange})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleMontaNaturalSubmit,className:\"mt-4 bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors\",children:\"Registrar Monta\"})]}),currentSection==='inseminacion'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border rounded-lg bg-gray-50\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold mb-3\",children:\"Registro de Inseminaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Vaca:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"vacaId\",className:\"w-full px-4 py-2 border rounded-lg\",value:inseminacionData.vacaId,onChange:handleInseminacionChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona Vaca\"}),animals.filter(a=>a.sexo==='hembra').map(vaca=>/*#__PURE__*/_jsxs(\"option\",{value:vaca.id,children:[vaca.name,\" (\",vaca.id,\")\"]},vaca.id))]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"ID Semen Utilizado:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"semenId\",placeholder:\"ID Semen Utilizado\",className:\"w-full px-4 py-2 border rounded-lg\",value:inseminacionData.semenId,onChange:handleInseminacionChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Fecha de Inseminaci\\xF3n:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaInseminacion\",placeholder:\"Fecha de Inseminaci\\xF3n\",className:\"w-full px-4 py-2 border rounded-lg\",value:inseminacionData.fechaInseminacion,onChange:handleInseminacionChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Inseminador:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"inseminador\",placeholder:\"Inseminador (Opcional)\",className:\"w-full px-4 py-2 border rounded-lg\",value:inseminacionData.inseminador,onChange:handleInseminacionChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1 col-span-full\",children:\"Observaciones:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"observaciones\",placeholder:\"Observaciones\",rows:\"2\",className:\"w-full px-4 py-2 border rounded-lg col-span-full\",value:inseminacionData.observaciones,onChange:handleInseminacionChange})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleInseminacionSubmit,className:\"mt-4 bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors\",children:\"Registrar Inseminaci\\xF3n\"})]}),currentSection==='gestacion'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border rounded-lg bg-gray-50\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold mb-3\",children:\"Control de Gestaci\\xF3n / Parto\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Vaca:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"vacaId\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.vacaId,onChange:handleGestacionChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona Vaca\"}),animals.filter(a=>a.sexo==='hembra').map(vaca=>/*#__PURE__*/_jsxs(\"option\",{value:vaca.id,children:[vaca.name,\" (\",vaca.id,\")\"]},vaca.id))]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Fecha Diagn\\xF3stico Gestaci\\xF3n:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaDiagnostico\",placeholder:\"Fecha de Diagn\\xF3stico de Gestaci\\xF3n\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.fechaDiagnostico,onChange:handleGestacionChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Resultado Diagn\\xF3stico:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"resultadoDiagnostico\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.resultadoDiagnostico,onChange:handleGestacionChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Resultado Diagn\\xF3stico\"}),/*#__PURE__*/_jsx(\"option\",{value:\"positiva\",children:\"Positiva (Pre\\xF1ada)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"negativa\",children:\"Negativa\"})]}),gestacionData.resultadoDiagnostico==='positiva'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Fecha de Parto Estimada:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaPartoEstimada\",placeholder:\"Fecha de Parto Estimada\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.fechaPartoEstimada,onChange:handleGestacionChange,title:\"Calculada autom\\xE1ticamente al registrar monta/inseminaci\\xF3n o diagn\\xF3stico positivo\"})]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Fecha de Parto Real (si ya ocurri\\xF3):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaPartoReal\",placeholder:\"Fecha de Parto Real (si ya ocurri\\xF3)\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.fechaPartoReal,onChange:handleGestacionChange}),gestacionData.fechaPartoReal&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Peso del Ternero (kg):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"pesoTernero\",placeholder:\"Peso del Ternero (kg)\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.pesoTernero,onChange:handleGestacionChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Sexo del Ternero:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"sexoTernero\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.sexoTernero,onChange:handleGestacionChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Sexo del Ternero\"}),/*#__PURE__*/_jsx(\"option\",{value:\"macho\",children:\"Macho\"}),/*#__PURE__*/_jsx(\"option\",{value:\"hembra\",children:\"Hembra\"})]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Nombre del Ternero:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"nombreTernero\",placeholder:\"Nombre del Ternero\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.nombreTernero,onChange:handleGestacionChange}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-full flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"isPadreRegistered\",name:\"isPadreRegistered\",checked:gestacionData.isPadreRegistered,onChange:handleGestacionChange,className:\"form-checkbox h-4 w-4 text-blue-600\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"isPadreRegistered\",className:\"text-gray-700 text-sm font-bold\",children:\"Padre registrado en la finca\"})]}),gestacionData.isPadreRegistered?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Seleccionar Padre:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"padreTerneroId\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.padreTerneroId,onChange:handleGestacionChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona Padre\"}),maleAnimals.map(toro=>/*#__PURE__*/_jsxs(\"option\",{value:toro.id,children:[toro.name,\" (\",toro.id,\")\"]},toro.id))]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Nombre del Padre del Ternero:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"padreTerneroNombre\",placeholder:\"Nombre del Padre del Ternero\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.padreTerneroNombre,onChange:handleGestacionChange}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Raza del Padre del Ternero:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"razaPadreTernero\",placeholder:\"Raza del Padre del Ternero\",className:\"w-full px-4 py-2 border rounded-lg\",value:gestacionData.razaPadreTernero,onChange:handleGestacionChange})]})]}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1 col-span-full\",children:\"Observaciones del Parto:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"observacionesParto\",placeholder:\"Observaciones del Parto\",rows:\"2\",className:\"w-full px-4 py-2 border rounded-lg col-span-full\",value:gestacionData.observacionesParto,onChange:handleGestacionChange})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGestacionSubmit,className:\"mt-4 bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors\",children:\"Registrar Gestaci\\xF3n / Parto\"})]}),currentSection==='historial'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border rounded-lg bg-gray-50\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold mb-3\",children:\"Historial Reproductivo\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap justify-between items-center mb-4 gap-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleAddManualEvent,className:\"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors\",children:\"Registrar Evento Manual\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-gray-700 text-sm font-bold\",children:\"Desde:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:filterStartDate,onChange:e=>setFilterStartDate(e.target.value),className:\"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-gray-700 text-sm font-bold\",children:\"Hasta:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:filterEndDate,onChange:e=>setFilterEndDate(e.target.value),className:\"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleExportHistory('csv'),className:\"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors mr-2\",children:\"Exportar a CSV\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleExportHistory('pdf'),className:\"bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors\",children:\"Exportar a PDF\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto rounded-lg shadow-md\",children:/*#__PURE__*/_jsxs(\"table\",{ref:historyTableRef,className:\"min-w-full bg-white text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-800 text-white\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold rounded-tl-lg\",children:\"ID Evento\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold\",children:\"ID Animal\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold\",children:\"Tipo Evento\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold\",children:\"Fecha Evento\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold\",children:\"Observaciones\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold\",children:\"Estado Posterior\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left font-semibold rounded-tr-lg\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:filteredReproductiveRecords.map(record=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-100 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:record.id}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:record.idAnimal}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:record.tipoEvento}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:record.fechaEvento}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:record.observaciones}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:record.estadoPosterior}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEditingHistoryRecord(record),className:\"text-blue-600 hover:text-blue-800 font-medium mr-2 transition-colors\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteHistoryRecord(record.id),className:\"text-red-600 hover:text-red-800 font-medium transition-colors\",children:\"Eliminar\"})]})]},record.id))})]})}),editingRecord&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 p-6 border rounded-lg bg-yellow-50 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-semibold mb-4 text-gray-800\",children:[\"Editar Registro Hist\\xF3rico: \",editingRecord.id]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Tipo Evento:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"tipoEvento\",className:\"w-full px-4 py-2 border rounded-lg bg-gray-200 cursor-not-allowed\",value:editingRecord.tipoEvento,readOnly:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Fecha Evento:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaEvento\",className:\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\",value:editingRecord.fechaEvento,onChange:handleEditingHistoryChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Estado Posterior:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"estadoPosterior\",className:\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\",value:editingRecord.estadoPosterior,onChange:handleEditingHistoryChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-1\",children:\"Observaciones:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"observaciones\",rows:\"3\",className:\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\",value:editingRecord.observaciones,onChange:handleEditingHistoryChange})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:saveEditedHistoryRecord,className:\"bg-green-600 text-white py-2 px-5 rounded-lg hover:bg-green-700 transition-colors shadow-md\",children:\"Guardar Cambios\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEditingHistoryRecord,className:\"bg-gray-600 text-white py-2 px-5 rounded-lg hover:bg-gray-700 transition-colors shadow-md\",children:\"Cancelar Edici\\xF3n\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold mb-3\",children:\"Vacas Pre\\xF1adas y Calendario de Gestaci\\xF3n\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white border text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-100\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border\",children:\"ID Vaca\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border\",children:\"Fecha Origen Gestaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border\",children:\"Fecha Parto Estimada\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border\",children:\"D\\xEDas Restantes\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:pregnantCows.map(vaca=>{const diasRestantes=calcularDiasRestantes(vaca.fechaPartoEstimada);const isOverdue=diasRestantes<0;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border\",children:vaca.id}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border\",children:vaca.name}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border\",children:vaca.fechaOrigenGestacion||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border \".concat(isOverdue?'text-red-600 font-bold':''),children:vaca.fechaPartoEstimada||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border \".concat(isOverdue?'text-red-600 font-bold':''),children:isNaN(diasRestantes)?'N/A':isOverdue?\"Venci\\xF3 hace \".concat(Math.abs(diasRestantes),\" d\\xEDas\"):diasRestantes}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border\",children:/*#__PURE__*/_jsx(\"button\",{className:\"text-red-600 hover:underline\",onClick:()=>onDeletePregnantCow(vaca.id),children:\"Eliminar\"})})]},vaca.id);})})]})})]})]});};export default ReproductiveControlPage;","map":{"version":3,"names":["React","useState","useEffect","useRef","classifyAnimalAge","exportToCsv","exportTableToPdf","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GESTATION_DAYS","ReproductiveControlPage","_ref","animals","onUpdateAnimalProduction","onRegisterReproductiveEvent","onDeletePregnantCow","reproductiveRecords","setReproductiveRecords","onRegisterAnimal","currentUser","logoUrl","currentSection","setCurrentSection","montaNaturalData","setMontaNaturalData","vacaId","toroId","fechaMonta","observaciones","inseminacionData","setInseminacionData","semenId","fechaInseminacion","inseminador","gestacionData","setGestacionData","fechaDiagnostico","resultadoDiagnostico","fechaPartoEstimada","fechaPartoReal","pesoTernero","sexoTernero","nombreTernero","observacionesParto","padreTerneroId","padreTerneroNombre","razaPadreTernero","isPadreRegistered","editingRecord","setEditingRecord","historyTableRef","filterStartDate","setFilterStartDate","filterEndDate","setFilterEndDate","calcularDiasRestantes","hoy","Date","fecha","isNaN","getTime","NaN","diferencia","Math","ceil","length","animalStatusUpdates","recordStatusUpdates","forEach","record","currentAnimal","find","a","id","idAnimal","tipoEvento","estadoPosterior","estado","estimatedBirthDateStr","diagnosisDate","fechaEvento","estimatedDate","setDate","getDate","toISOString","split","push","update","dias","estadoReproductivo","fechaUltimoParto","newReproductiveRecords","map","rec","u","_objectSpread","handleMontaNaturalChange","e","name","value","target","handleInseminacionChange","handleGestacionChange","type","checked","updatedGestacionData","diagnosisDateObj","handleMontaNaturalSubmit","alert","montaDateObj","estimatedBirthDateForRecord","concat","now","toString","slice","handleInseminacionSubmit","inseminacionDateObj","handleGestacionSubmit","newAnimalState","fechaUltimaGestacion","_animals$find","_animals$find2","birthYear","getFullYear","newCalfId","newCalf","raza","peso","sexo","fechaNacimiento","fechaCompra","tipoProduccion","idpadre","razaPadre","idmadre","edadClasificada","handleDeleteHistoryRecord","recordId","window","confirm","updatedRecords","filter","startEditingHistoryRecord","handleEditingHistoryChange","prev","saveEditedHistoryRecord","cancelEditingHistoryRecord","handleAddManualEvent","animalId","prompt","handleExportHistory","format","filename","farmName","adminName","fullName","current","pregnantCows","animal","lastPositiveDiagnosis","sort","b","lastMontaInseminacion","fechaOrigenGestacion","origenDateObj","filteredReproductiveRecords","recordDate","start","end","maleAnimals","className","children","onClick","onChange","vaca","toro","placeholder","rows","title","htmlFor","ref","readOnly","diasRestantes","isOverdue","abs"],"sources":["C:/Users/User/Downloads/project (10)/src/components/ReproductiveControlPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { classifyAnimalAge } from '../utils/helpers'; // Importar la función de utilidad\nimport { exportToCsv, exportTableToPdf } from '../utils/exportHelpers'; // Importar funciones de exportación\n\nconst GESTATION_DAYS = 283; // Días promedio de gestación para bovinos\n\nconst ReproductiveControlPage = ({ animals, onUpdateAnimalProduction, onRegisterReproductiveEvent, onDeletePregnantCow, reproductiveRecords, setReproductiveRecords, onRegisterAnimal, currentUser, logoUrl }) => {\n  const [currentSection, setCurrentSection] = useState('montaNatural'); // 'montaNatural', 'inseminacion', 'gestacion', 'historial'\n\n  const [montaNaturalData, setMontaNaturalData] = useState({\n    vacaId: '',\n    toroId: '',\n    fechaMonta: '',\n    observaciones: '',\n  });\n\n  const [inseminacionData, setInseminacionData] = useState({\n    vacaId: '',\n    semenId: '', // ID del semen utilizado\n    fechaInseminacion: '',\n    inseminador: '',\n    observaciones: '',\n  });\n\n  const [gestacionData, setGestacionData] = useState({\n    vacaId: '',\n    fechaDiagnostico: '',\n    resultadoDiagnostico: '', // 'positiva', 'negativa'\n    fechaPartoEstimada: '', // Calculada\n    fechaPartoReal: '',\n    pesoTernero: '',\n    sexoTernero: '',\n    nombreTernero: '',\n    observacionesParto: '',\n    padreTerneroId: '', // ID del padre si está registrado\n    padreTerneroNombre: '', // Nombre del padre si es nuevo\n    razaPadreTernero: '', // Raza del padre si es nuevo\n    isPadreRegistered: false, // Para controlar si el padre está registrado\n  });\n\n  const [editingRecord, setEditingRecord] = useState(null); // To hold the record being edited\n  const historyTableRef = useRef(null); // Ref for the history table\n\n  const [filterStartDate, setFilterStartDate] = useState('');\n  const [filterEndDate, setFilterEndDate] = useState('');\n\n  // Función auxiliar para calcular días restantes\n  const calcularDiasRestantes = (fechaPartoEstimada) => {\n    const hoy = new Date();\n    const fecha = new Date(fechaPartoEstimada);\n    // Verificar si la fecha es válida antes de calcular la diferencia\n    if (isNaN(fecha.getTime())) {\n      return NaN; // Retorna NaN si la fecha no es válida\n    }\n    const diferencia = fecha.getTime() - hoy.getTime(); // Usar getTime() para operar con milisegundos\n    return Math.ceil(diferencia / (1000 * 60 * 60 * 24));\n  };\n\n  // useEffect para evaluar registros reproductivos y actualizar estados\n  useEffect(() => {\n    if (!reproductiveRecords || reproductiveRecords.length === 0) {\n      return;\n    }\n\n    let animalStatusUpdates = [];\n    let recordStatusUpdates = [];\n\n    reproductiveRecords.forEach(record => {\n      const currentAnimal = animals.find(a => a.id === record.idAnimal);\n      if (!currentAnimal) return; // Animal not found, skip\n\n      // Logic for 'preñada' records that are not yet finalized\n      if (record.tipoEvento === 'diagnóstico' && record.estadoPosterior === 'preñada' && record.estado !== 'finalizado') {\n        let estimatedBirthDateStr = record.fechaPartoEstimada;\n\n        // If estimated birth date is missing, calculate it from the diagnosis date\n        if (!estimatedBirthDateStr) {\n          const diagnosisDate = new Date(record.fechaEvento);\n          if (diagnosisDate instanceof Date && !isNaN(diagnosisDate.getTime())) {\n            const estimatedDate = new Date(diagnosisDate);\n            estimatedDate.setDate(estimatedDate.getDate() + GESTATION_DAYS);\n            estimatedBirthDateStr = estimatedDate.toISOString().split('T')[0];\n            // Update the record itself with the estimated date for persistence\n            recordStatusUpdates.push({ id: record.id, update: { fechaPartoEstimada: estimatedBirthDateStr } });\n          }\n        }\n\n        if (estimatedBirthDateStr) {\n          const dias = calcularDiasRestantes(estimatedBirthDateStr);\n\n          // Solo aplicar reglas si los días restantes son un número válido\n          if (!isNaN(dias)) {\n            // Rule 1: Change to SECA if less than 100 days to birth AND animal is not already 'seca'\n            if (dias <= 100 && dias > 0 && currentAnimal.estadoReproductivo !== 'seca') {\n              animalStatusUpdates.push({ id: record.idAnimal, update: { estadoReproductivo: 'seca' } });\n            }\n\n            // Rule 2: Change to PRODUCCIÓN if estimated birth date passed AND animal is not already 'produccion'\n            if (dias <= 0 && currentAnimal.estadoReproductivo !== 'produccion') {\n              animalStatusUpdates.push({ id: record.idAnimal, update: { estadoReproductivo: 'produccion', fechaUltimoParto: estimatedBirthDateStr } });\n              // Mark the reproductive record as finalized after birth\n              recordStatusUpdates.push({ id: record.id, update: { estado: 'finalizado' } });\n            }\n          }\n        }\n      }\n    });\n\n    // Apply animal status updates\n    animalStatusUpdates.forEach(update => {\n      onUpdateAnimalProduction(update.id, update.update);\n    });\n\n    // Apply reproductive record status updates\n    if (recordStatusUpdates.length > 0) {\n      const newReproductiveRecords = reproductiveRecords.map(rec => {\n        const update = recordStatusUpdates.find(u => u.id === rec.id);\n        return update ? { ...rec, ...update.update } : rec;\n      });\n      setReproductiveRecords(newReproductiveRecords);\n    }\n\n  }, [reproductiveRecords, animals, onUpdateAnimalProduction, setReproductiveRecords]); // Dependencies\n\n  const handleMontaNaturalChange = (e) => {\n    const { name, value } = e.target;\n    setMontaNaturalData({ ...montaNaturalData, [name]: value });\n  };\n\n  const handleInseminacionChange = (e) => {\n    const { name, value } = e.target;\n    setInseminacionData({ ...inseminacionData, [name]: value });\n  };\n\n  const handleGestacionChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    let updatedGestacionData = { ...gestacionData, [name]: value };\n\n    if (type === 'checkbox') {\n      updatedGestacionData = { ...gestacionData, [name]: checked };\n    } else if (name === 'fechaDiagnostico' && updatedGestacionData.resultadoDiagnostico === 'positiva') {\n      // Recalcular fechaPartoEstimada si cambia la fechaDiagnostico y el resultado es positivo\n      const diagnosisDateObj = new Date(value);\n      if (diagnosisDateObj instanceof Date && !isNaN(diagnosisDateObj.getTime())) {\n        const estimatedDate = new Date(diagnosisDateObj);\n        estimatedDate.setDate(estimatedDate.getDate() + GESTATION_DAYS);\n        updatedGestacionData.fechaPartoEstimada = estimatedDate.toISOString().split('T')[0];\n      } else {\n        updatedGestacionData.fechaPartoEstimada = '';\n      }\n    } else if (name === 'resultadoDiagnostico' && value === 'positiva' && updatedGestacionData.fechaDiagnostico) {\n      // Recalcular fechaPartoEstimada si el resultado cambia a positivo y ya hay fechaDiagnostico\n      const diagnosisDateObj = new Date(updatedGestacionData.fechaDiagnostico);\n      if (diagnosisDateObj instanceof Date && !isNaN(diagnosisDateObj.getTime())) {\n        const estimatedDate = new Date(diagnosisDateObj);\n        estimatedDate.setDate(estimatedDate.getDate() + GESTATION_DAYS);\n        updatedGestacionData.fechaPartoEstimada = estimatedDate.toISOString().split('T')[0];\n      } else {\n        updatedGestacionData.fechaPartoEstimada = '';\n      }\n    } else if (name === 'resultadoDiagnostico' && value === 'negativa') {\n      // Limpiar fechaPartoEstimada si el resultado es negativo\n      updatedGestacionData.fechaPartoEstimada = '';\n    }\n\n    setGestacionData(updatedGestacionData);\n  };\n\n  const handleMontaNaturalSubmit = () => {\n    const { vacaId, toroId, fechaMonta, observaciones } = montaNaturalData;\n\n    if (!vacaId || !toroId || !fechaMonta) {\n      alert('¡Ups! Parece que te faltan algunos datos para registrar la monta natural. ¡Completa todos los campos y lo intentamos de nuevo!');\n      return;\n    }\n\n    // Calcular fecha de parto estimada para el registro\n    const montaDateObj = new Date(fechaMonta);\n    let estimatedBirthDateForRecord = '';\n    if (montaDateObj instanceof Date && !isNaN(montaDateObj.getTime())) {\n      const estimatedDate = new Date(montaDateObj);\n      estimatedDate.setDate(estimatedDate.getDate() + GESTATION_DAYS);\n      estimatedBirthDateForRecord = estimatedDate.toISOString().split('T')[0];\n    }\n\n    onRegisterReproductiveEvent({\n      id: `REC-${Date.now().toString().slice(-5)}`, // Generar ID único\n      idAnimal: vacaId,\n      tipoEvento: 'monta',\n      fechaEvento: fechaMonta,\n      observaciones,\n      estadoPosterior: 'posiblemente preñada', // Estado inicial después de monta/inseminación\n      toroId,\n      fechaPartoEstimada: estimatedBirthDateForRecord, // Guardar fecha de parto estimada\n    });\n\n    alert('¡Excelente! La monta natural ha sido registrada con éxito. ¡Esperemos que pronto tengamos buenas noticias!');\n    setMontaNaturalData({ vacaId: '', toroId: '', fechaMonta: '', observaciones: '' });\n  };\n\n  const handleInseminacionSubmit = () => {\n    const { vacaId, semenId, fechaInseminacion, observaciones } = inseminacionData;\n\n    if (!vacaId || !semenId || !fechaInseminacion) {\n      alert('¡Uy! Para registrar la inseminación, necesitamos que llenes todos los campos. ¡No te rindas, ya casi lo logras!');\n      return;\n    }\n\n    // Calcular fecha de parto estimada para el registro\n    const inseminacionDateObj = new Date(fechaInseminacion);\n    let estimatedBirthDateForRecord = '';\n    if (inseminacionDateObj instanceof Date && !isNaN(inseminacionDateObj.getTime())) {\n      const estimatedDate = new Date(inseminacionDateObj);\n      estimatedDate.setDate(estimatedDate.getDate() + GESTATION_DAYS);\n      estimatedBirthDateForRecord = estimatedDate.toISOString().split('T')[0];\n    }\n\n    onRegisterReproductiveEvent({\n      id: `REC-${Date.now().toString().slice(-5)}`, // Generar ID único\n      idAnimal: vacaId,\n      tipoEvento: 'inseminacion',\n      fechaEvento: fechaInseminacion,\n      observaciones,\n      estadoPosterior: 'posiblemente preñada', // Estado inicial después de monta/inseminación\n      toroId: semenId, // opcional\n      fechaPartoEstimada: estimatedBirthDateForRecord, // Guardar fecha de parto estimada\n    });\n\n    alert('¡Genial! La inseminación ha sido registrada. ¡Crucemos los dedos por un buen resultado!');\n\n    setInseminacionData({\n      vacaId: '',\n      semenId: '',\n      fechaInseminacion: '',\n      observaciones: '',\n    });\n  };\n\n  const handleGestacionSubmit = () => {\n    const {\n      vacaId,\n      fechaDiagnostico,\n      resultadoDiagnostico,\n      pesoTernero,\n      sexoTernero,\n      nombreTernero,\n      observacionesParto,\n      fechaPartoReal,\n      padreTerneroId,\n      padreTerneroNombre,\n      razaPadreTernero,\n      isPadreRegistered,\n      fechaPartoEstimada // Usar la fechaPartoEstimada del estado\n    } = gestacionData;\n\n    if (!vacaId || !fechaDiagnostico || !resultadoDiagnostico) {\n      alert('¡Atención! Para el diagnóstico de gestación, necesitamos que completes los campos obligatorios. ¡Vamos, tú puedes!');\n      return;\n    }\n\n    let newAnimalState = '';\n\n    if (resultadoDiagnostico === 'positiva') {\n      newAnimalState = 'preñada';\n    } else {\n      newAnimalState = 'vacia';\n    }\n\n    // Actualizar el estado reproductivo de la vaca\n    onUpdateAnimalProduction(vacaId, {\n      estadoReproductivo: newAnimalState,\n      fechaUltimaGestacion: newAnimalState === 'preñada' ? fechaDiagnostico : '',\n    });\n\n    // Registrar el evento de diagnóstico\n    onRegisterReproductiveEvent({\n      id: `REC-${Date.now().toString().slice(-5)}`,\n      idAnimal: vacaId,\n      tipoEvento: 'diagnóstico',\n      fechaEvento: fechaDiagnostico,\n      observaciones: `Diagnóstico: ${resultadoDiagnostico}. ${observacionesParto}`,\n      estadoPosterior: newAnimalState,\n      fechaPartoEstimada: fechaPartoEstimada, // Usar la fechaPartoEstimada del estado\n    });\n\n    // Si se registró una fecha de parto real\n    if (fechaPartoReal) {\n      onUpdateAnimalProduction(vacaId, {\n        estadoReproductivo: 'produccion',\n        fechaUltimoParto: fechaPartoReal,\n      });\n\n      onRegisterReproductiveEvent({\n        id: `REC-${Date.now().toString().slice(-5)}`,\n        idAnimal: vacaId,\n        tipoEvento: 'parto',\n        fechaEvento: fechaPartoReal,\n        observaciones: observacionesParto,\n        estadoPosterior: 'produccion',\n      });\n\n      if (nombreTernero && sexoTernero && pesoTernero) {\n        const birthYear = new Date(fechaPartoReal).getFullYear().toString().slice(-2);\n        const newCalfId = `${vacaId}-${birthYear}`; \n        \n        const newCalf = {\n          id: newCalfId,\n          name: nombreTernero,\n          raza: animals.find(a => a.id === vacaId)?.raza || 'Desconocida',\n          peso: pesoTernero,\n          sexo: sexoTernero,\n          fechaNacimiento: fechaPartoReal,\n          fechaCompra: '',\n          tipoProduccion: '',\n          idpadre: isPadreRegistered ? padreTerneroId : padreTerneroNombre,\n          razaPadre: isPadreRegistered ? animals.find(a => a.id === padreTerneroId)?.raza || 'Desconocida' : razaPadreTernero,\n          idmadre: vacaId,\n          estadoReproductivo: 'desarrollo',\n          edadClasificada: classifyAnimalAge(fechaPartoReal, sexoTernero),\n        };\n        onRegisterAnimal(newCalf);\n        alert(`¡Felicidades! El ternero ${nombreTernero} ha sido registrado automáticamente con ID: ${newCalfId}. ¡Un nuevo miembro en la familia!`);\n      }\n    }\n\n    alert('¡Diagnóstico de gestación registrado! Mantente al tanto de las novedades.');\n    setGestacionData({\n      vacaId: '',\n      fechaDiagnostico: '',\n      resultadoDiagnostico: '',\n      fechaPartoEstimada: '',\n      pesoTernero: '',\n      sexoTernero: '',\n      nombreTernero: '',\n      observacionesParto: '',\n      fechaPartoReal: '',\n      padreTerneroId: '',\n      padreTerneroNombre: '',\n      razaPadreTernero: '',\n      isPadreRegistered: false,\n    });\n  };\n\n  const handleDeleteHistoryRecord = (recordId) => {\n    if (window.confirm('¿Estás seguro de que quieres eliminar este registro? ¡Esta acción no se puede deshacer!')) {\n      const updatedRecords = reproductiveRecords.filter(record => record.id !== recordId);\n      setReproductiveRecords(updatedRecords); // Update state in App.js via prop\n      alert('¡Registro eliminado! Como si nunca hubiera existido.');\n    }\n  };\n\n  const startEditingHistoryRecord = (record) => {\n    setEditingRecord({ ...record }); // Create a copy to edit\n    alert('¡A editar se ha dicho! Modifica los campos y guarda los cambios.');\n  };\n\n  const handleEditingHistoryChange = (e) => {\n    const { name, value } = e.target;\n    setEditingRecord(prev => ({ ...prev, [name]: value }));\n  };\n\n  const saveEditedHistoryRecord = () => {\n    const updatedRecords = reproductiveRecords.map(record =>\n      record.id === editingRecord.id ? editingRecord : record\n    );\n    setReproductiveRecords(updatedRecords); // Update state in App.js via prop\n    setEditingRecord(null); // Exit editing mode\n    alert('¡Cambios guardados! Tu historial está al día.');\n  };\n\n  const cancelEditingHistoryRecord = () => {\n    setEditingRecord(null); // Exit editing mode\n    alert('¡Edición cancelada! No te preocupes, tus datos están a salvo.');\n  };\n\n  // Function to add a manual reproductive event\n  const handleAddManualEvent = () => {\n    const animalId = prompt(\"Ingresa el ID del animal para el evento manual:\");\n    const tipoEvento = prompt(\"¿Qué tipo de evento quieres registrar? (ej. 'observacion', 'tratamiento'):\");\n    const fechaEvento = prompt(\"¿Cuándo ocurrió el evento? (YYYY-MM-DD):\");\n    const observaciones = prompt(\"¿Alguna observación adicional sobre este evento?:\");\n    const estadoPosterior = prompt(\"¿Cuál es el estado del animal después de este evento? (ej. 'vacia', 'produccion'):\");\n\n    if (animalId && tipoEvento && fechaEvento) {\n      onRegisterReproductiveEvent({\n        id: `REC-${Date.now().toString().slice(-5)}`, // Generar ID único\n        idAnimal: animalId,\n        tipoEvento: tipoEvento,\n        fechaEvento: fechaEvento,\n        observaciones: observaciones,\n        estadoPosterior: estadoPosterior,\n      });\n      alert('¡Evento manual registrado! Tu historial sigue creciendo.');\n    } else {\n      alert('¡Ojo! Para registrar un evento manual, necesitamos el ID del animal, el tipo de evento y la fecha. ¡Inténtalo de nuevo!');\n    }\n  };\n\n  const handleExportHistory = async (format) => {\n    if (reproductiveRecords.length === 0) {\n      alert('¡No hay registros para exportar! ¿Qué esperas para empezar a registrar?');\n      return;\n    }\n\n    const filename = `historial_reproductivo_${new Date().toISOString().split('T')[0]}`;\n    const farmName = currentUser?.farmName || 'Mi Finca Ganadera';\n    const adminName = currentUser?.fullName || 'Administrador';\n\n    if (format === 'csv') {\n      exportToCsv(reproductiveRecords, filename);\n      alert('¡Exportando a CSV! Tu historial estará listo en un santiamén.');\n    } else if (format === 'pdf') {\n      await exportTableToPdf(historyTableRef.current, filename, 'Historial Reproductivo', farmName, adminName, logoUrl);\n      alert('¡Generando PDF! Tu historial se verá de lujo en papel.');\n    }\n  };\n\n  // Filtrar vacas preñadas para la tabla\n  const pregnantCows = animals.filter(animal => \n    animal.sexo === 'hembra' && animal.estadoReproductivo === 'preñada'\n  ).map(animal => {\n    // Encontrar el último registro de gestación positiva para obtener la fecha de parto estimada\n    const lastPositiveDiagnosis = reproductiveRecords\n      .filter(rec => rec.idAnimal === animal.id && rec.tipoEvento === 'diagnóstico' && rec.estadoPosterior === 'preñada')\n      .sort((a, b) => new Date(b.fechaEvento) - new Date(a.fechaEvento))[0];\n\n    const lastMontaInseminacion = reproductiveRecords\n      .filter(rec => rec.idAnimal === animal.id && (rec.tipoEvento === 'monta' || rec.tipoEvento === 'inseminacion'))\n      .sort((a, b) => new Date(b.fechaEvento) - new Date(a.fechaEvento))[0];\n\n    let fechaOrigenGestacion = '';\n    let fechaPartoEstimada = '';\n\n    if (lastPositiveDiagnosis && lastPositiveDiagnosis.fechaPartoEstimada) {\n      fechaOrigenGestacion = lastPositiveDiagnosis.fechaEvento;\n      fechaPartoEstimada = lastPositiveDiagnosis.fechaPartoEstimada;\n    } else if (lastMontaInseminacion) {\n      fechaOrigenGestacion = lastMontaInseminacion.fechaEvento;\n      const origenDateObj = new Date(fechaOrigenGestacion);\n      if (origenDateObj instanceof Date && !isNaN(origenDateObj.getTime())) {\n        const estimatedDate = new Date(origenDateObj);\n        estimatedDate.setDate(estimatedDate.getDate() + GESTATION_DAYS);\n        fechaPartoEstimada = estimatedDate.toISOString().split('T')[0];\n      }\n    }\n\n    return {\n      ...animal,\n      fechaOrigenGestacion: fechaOrigenGestacion,\n      fechaPartoEstimada: fechaPartoEstimada,\n    };\n  }).filter(animal => animal.fechaPartoEstimada); // Solo incluir vacas con fecha de parto estimada\n\n  const filteredReproductiveRecords = reproductiveRecords.filter(record => {\n    const recordDate = new Date(record.fechaEvento);\n    const start = filterStartDate ? new Date(filterStartDate) : null;\n    const end = filterEndDate ? new Date(filterEndDate) : null;\n\n    if (start && recordDate < start) return false;\n    if (end && recordDate > end) return false;\n    return true;\n  });\n\n  const maleAnimals = animals.filter(a => a.sexo === 'macho');\n\n  return (\n    <div className=\"bg-white p-6 rounded-lg shadow-md\">\n      <h3 className=\"text-xl font-semibold mb-4\">Control Reproductivo</h3>\n\n      <div className=\"flex justify-center mb-6 space-x-4\">\n        <button\n          onClick={() => setCurrentSection('montaNatural')}\n          className={`px-6 py-2 rounded-lg ${currentSection === 'montaNatural' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800'} hover:bg-blue-700 transition-colors`}\n        >\n          Monta Natural\n        </button>\n        <button\n          onClick={() => setCurrentSection('inseminacion')}\n          className={`px-6 py-2 rounded-lg ${currentSection === 'inseminacion' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800'} hover:bg-blue-700 transition-colors`}\n        >\n          Inseminación\n        </button>\n        <button\n          onClick={() => setCurrentSection('gestacion')}\n          className={`px-6 py-2 rounded-lg ${currentSection === 'gestacion' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800'} hover:bg-blue-700 transition-colors`}\n        >\n          Control de Gestación / Parto\n        </button>\n        <button\n          onClick={() => setCurrentSection('historial')}\n          className={`px-6 py-2 rounded-lg ${currentSection === 'historial' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800'} hover:bg-blue-700 transition-colors`}\n        >\n          Historial Reproductivo\n        </button>\n      </div>\n\n      {currentSection === 'montaNatural' && (\n        <div className=\"p-4 border rounded-lg bg-gray-50\">\n          <h4 className=\"text-lg font-semibold mb-3\">Registro de Monta Natural</h4>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Vaca:</label>\n            <select\n              name=\"vacaId\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={montaNaturalData.vacaId}\n              onChange={handleMontaNaturalChange}\n            >\n              <option value=\"\">Selecciona Vaca</option>\n              {animals.filter(a => a.sexo === 'hembra').map(vaca => (\n                <option key={vaca.id} value={vaca.id}>{vaca.name} ({vaca.id})</option>\n              ))}\n            </select>\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Toro:</label>\n            <select\n              name=\"toroId\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={montaNaturalData.toroId}\n              onChange={handleMontaNaturalChange}\n            >\n              <option value=\"\">Selecciona Toro</option>\n              {animals.filter(a => a.sexo === 'macho').map(toro => (\n                <option key={toro.id} value={toro.id}>{toro.name} ({toro.id})</option>\n              ))}\n            </select>\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Fecha de Monta:</label>\n            <input\n              type=\"date\"\n              name=\"fechaMonta\"\n              placeholder=\"Fecha de Monta\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={montaNaturalData.fechaMonta}\n              onChange={handleMontaNaturalChange}\n            />\n            <label className=\"block text-gray-700 text-sm font-bold mb-1 col-span-full\">Observaciones:</label>\n            <textarea\n              name=\"observaciones\"\n              placeholder=\"Observaciones\"\n              rows=\"2\"\n              className=\"w-full px-4 py-2 border rounded-lg col-span-full\"\n              value={montaNaturalData.observaciones}\n              onChange={handleMontaNaturalChange}\n            ></textarea>\n          </div>\n          <button\n            onClick={handleMontaNaturalSubmit}\n            className=\"mt-4 bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors\"\n          >\n            Registrar Monta\n          </button>\n        </div>\n      )}\n\n      {currentSection === 'inseminacion' && (\n        <div className=\"p-4 border rounded-lg bg-gray-50\">\n          <h4 className=\"text-lg font-semibold mb-3\">Registro de Inseminación</h4>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Vaca:</label>\n            <select\n              name=\"vacaId\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={inseminacionData.vacaId}\n              onChange={handleInseminacionChange}\n            >\n              <option value=\"\">Selecciona Vaca</option>\n              {animals.filter(a => a.sexo === 'hembra').map(vaca => (\n                <option key={vaca.id} value={vaca.id}>{vaca.name} ({vaca.id})</option>\n              ))}\n            </select>\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">ID Semen Utilizado:</label>\n            <input\n              type=\"text\"\n              name=\"semenId\"\n              placeholder=\"ID Semen Utilizado\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={inseminacionData.semenId}\n              onChange={handleInseminacionChange}\n            />\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Fecha de Inseminación:</label>\n            <input\n              type=\"date\"\n              name=\"fechaInseminacion\"\n              placeholder=\"Fecha de Inseminación\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={inseminacionData.fechaInseminacion}\n              onChange={handleInseminacionChange}\n            />\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Inseminador:</label>\n            <input\n              type=\"text\"\n              name=\"inseminador\"\n              placeholder=\"Inseminador (Opcional)\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={inseminacionData.inseminador}\n              onChange={handleInseminacionChange}\n            />\n            <label className=\"block text-gray-700 text-sm font-bold mb-1 col-span-full\">Observaciones:</label>\n            <textarea\n              name=\"observaciones\"\n              placeholder=\"Observaciones\"\n              rows=\"2\"\n              className=\"w-full px-4 py-2 border rounded-lg col-span-full\"\n              value={inseminacionData.observaciones}\n              onChange={handleInseminacionChange}\n            ></textarea>\n          </div>\n          <button\n            onClick={handleInseminacionSubmit}\n            className=\"mt-4 bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors\"\n          >\n            Registrar Inseminación\n          </button>\n        </div>\n      )}\n\n      {currentSection === 'gestacion' && (\n        <div className=\"p-4 border rounded-lg bg-gray-50\">\n          <h4 className=\"text-lg font-semibold mb-3\">Control de Gestación / Parto</h4>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Vaca:</label>\n            <select\n              name=\"vacaId\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={gestacionData.vacaId}\n              onChange={handleGestacionChange}\n            >\n              <option value=\"\">Selecciona Vaca</option>\n              {animals.filter(a => a.sexo === 'hembra').map(vaca => (\n                <option key={vaca.id} value={vaca.id}>{vaca.name} ({vaca.id})</option>\n              ))}\n            </select>\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Fecha Diagnóstico Gestación:</label>\n            <input\n              type=\"date\"\n              name=\"fechaDiagnostico\"\n              placeholder=\"Fecha de Diagnóstico de Gestación\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={gestacionData.fechaDiagnostico}\n              onChange={handleGestacionChange}\n            />\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Resultado Diagnóstico:</label>\n            <select\n              name=\"resultadoDiagnostico\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={gestacionData.resultadoDiagnostico}\n              onChange={handleGestacionChange}\n            >\n              <option value=\"\">Resultado Diagnóstico</option>\n              <option value=\"positiva\">Positiva (Preñada)</option>\n              <option value=\"negativa\">Negativa</option>\n            </select>\n            {gestacionData.resultadoDiagnostico === 'positiva' && (\n              <>\n                <label className=\"block text-gray-700 text-sm font-bold mb-1\">Fecha de Parto Estimada:</label>\n                <input\n                  type=\"date\"\n                  name=\"fechaPartoEstimada\"\n                  placeholder=\"Fecha de Parto Estimada\"\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                  value={gestacionData.fechaPartoEstimada}\n                  onChange={handleGestacionChange}\n                  title=\"Calculada automáticamente al registrar monta/inseminación o diagnóstico positivo\"\n                />\n              </>\n            )}\n            <label className=\"block text-gray-700 text-sm font-bold mb-1\">Fecha de Parto Real (si ya ocurrió):</label>\n            <input\n              type=\"date\"\n              name=\"fechaPartoReal\"\n              placeholder=\"Fecha de Parto Real (si ya ocurrió)\"\n              className=\"w-full px-4 py-2 border rounded-lg\"\n              value={gestacionData.fechaPartoReal}\n              onChange={handleGestacionChange}\n            />\n            {gestacionData.fechaPartoReal && (\n              <>\n                <label className=\"block text-gray-700 text-sm font-bold mb-1\">Peso del Ternero (kg):</label>\n                <input\n                  type=\"number\"\n                  name=\"pesoTernero\"\n                  placeholder=\"Peso del Ternero (kg)\"\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                  value={gestacionData.pesoTernero}\n                  onChange={handleGestacionChange}\n                />\n                <label className=\"block text-gray-700 text-sm font-bold mb-1\">Sexo del Ternero:</label>\n                <select\n                  name=\"sexoTernero\"\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                  value={gestacionData.sexoTernero}\n                  onChange={handleGestacionChange}\n                >\n                  <option value=\"\">Sexo del Ternero</option>\n                  <option value=\"macho\">Macho</option>\n                  <option value=\"hembra\">Hembra</option>\n                </select>\n                <label className=\"block text-gray-700 text-sm font-bold mb-1\">Nombre del Ternero:</label>\n                <input\n                  type=\"text\"\n                  name=\"nombreTernero\"\n                  placeholder=\"Nombre del Ternero\"\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                  value={gestacionData.nombreTernero}\n                  onChange={handleGestacionChange}\n                />\n\n                <div className=\"col-span-full flex items-center space-x-2\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"isPadreRegistered\"\n                    name=\"isPadreRegistered\"\n                    checked={gestacionData.isPadreRegistered}\n                    onChange={handleGestacionChange}\n                    className=\"form-checkbox h-4 w-4 text-blue-600\"\n                  />\n                  <label htmlFor=\"isPadreRegistered\" className=\"text-gray-700 text-sm font-bold\">Padre registrado en la finca</label>\n                </div>\n\n                {gestacionData.isPadreRegistered ? (\n                  <>\n                    <label className=\"block text-gray-700 text-sm font-bold mb-1\">Seleccionar Padre:</label>\n                    <select\n                      name=\"padreTerneroId\"\n                      className=\"w-full px-4 py-2 border rounded-lg\"\n                      value={gestacionData.padreTerneroId}\n                      onChange={handleGestacionChange}\n                    >\n                      <option value=\"\">Selecciona Padre</option>\n                      {maleAnimals.map(toro => (\n                        <option key={toro.id} value={toro.id}>{toro.name} ({toro.id})</option>\n                      ))}\n                    </select>\n                  </>\n                ) : (\n                  <>\n                    <label className=\"block text-gray-700 text-sm font-bold mb-1\">Nombre del Padre del Ternero:</label>\n                    <input\n                      type=\"text\"\n                      name=\"padreTerneroNombre\"\n                      placeholder=\"Nombre del Padre del Ternero\"\n                      className=\"w-full px-4 py-2 border rounded-lg\"\n                      value={gestacionData.padreTerneroNombre}\n                      onChange={handleGestacionChange}\n                    />\n                    <label className=\"block text-gray-700 text-sm font-bold mb-1\">Raza del Padre del Ternero:</label>\n                    <input\n                      type=\"text\"\n                      name=\"razaPadreTernero\"\n                      placeholder=\"Raza del Padre del Ternero\"\n                      className=\"w-full px-4 py-2 border rounded-lg\"\n                      value={gestacionData.razaPadreTernero}\n                      onChange={handleGestacionChange}\n                    />\n                  </>\n                )}\n              </>\n            )}\n            <label className=\"block text-gray-700 text-sm font-bold mb-1 col-span-full\">Observaciones del Parto:</label>\n            <textarea\n              name=\"observacionesParto\"\n              placeholder=\"Observaciones del Parto\"\n              rows=\"2\"\n              className=\"w-full px-4 py-2 border rounded-lg col-span-full\"\n              value={gestacionData.observacionesParto}\n              onChange={handleGestacionChange}\n            ></textarea>\n          </div>\n          <button\n            onClick={handleGestacionSubmit}\n            className=\"mt-4 bg-black text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors\"\n          >\n            Registrar Gestación / Parto\n          </button>\n        </div>\n      )}\n\n      {currentSection === 'historial' && (\n        <div className=\"p-4 border rounded-lg bg-gray-50\">\n          <h4 className=\"text-lg font-semibold mb-3\">Historial Reproductivo</h4>\n          <div className=\"flex flex-wrap justify-between items-center mb-4 gap-4\">\n            <button\n              onClick={handleAddManualEvent}\n              className=\"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors\"\n            >\n              Registrar Evento Manual\n            </button>\n            <div className=\"flex items-center space-x-2\">\n              <label className=\"text-gray-700 text-sm font-bold\">Desde:</label>\n              <input\n                type=\"date\"\n                value={filterStartDate}\n                onChange={(e) => setFilterStartDate(e.target.value)}\n                className=\"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"\n              />\n              <label className=\"text-gray-700 text-sm font-bold\">Hasta:</label>\n              <input\n                type=\"date\"\n                value={filterEndDate}\n                onChange={(e) => setFilterEndDate(e.target.value)}\n                className=\"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"\n              />\n            </div>\n            <div>\n              <button\n                onClick={() => handleExportHistory('csv')}\n                className=\"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors mr-2\"\n              >\n                Exportar a CSV\n              </button>\n              <button\n                onClick={() => handleExportHistory('pdf')}\n                className=\"bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors\"\n              >\n                Exportar a PDF\n              </button>\n            </div>\n          </div>\n          <div className=\"overflow-x-auto rounded-lg shadow-md\">\n            <table ref={historyTableRef} className=\"min-w-full bg-white text-sm\">\n              <thead className=\"bg-gray-800 text-white\">\n                <tr>\n                  <th className=\"py-3 px-4 text-left font-semibold rounded-tl-lg\">ID Evento</th>\n                  <th className=\"py-3 px-4 text-left font-semibold\">ID Animal</th>\n                  <th className=\"py-3 px-4 text-left font-semibold\">Tipo Evento</th>\n                  <th className=\"py-3 px-4 text-left font-semibold\">Fecha Evento</th>\n                  <th className=\"py-3 px-4 text-left font-semibold\">Observaciones</th>\n                  <th className=\"py-3 px-4 text-left font-semibold\">Estado Posterior</th>\n                  <th className=\"py-3 px-4 text-left font-semibold rounded-tr-lg\">Acciones</th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-gray-200\">\n                {filteredReproductiveRecords.map((record) => (\n                  <tr key={record.id} className=\"hover:bg-gray-100 transition-colors\">\n                    <td className=\"py-3 px-4\">{record.id}</td>\n                    <td className=\"py-3 px-4\">{record.idAnimal}</td>\n                    <td className=\"py-3 px-4\">{record.tipoEvento}</td>\n                    <td className=\"py-3 px-4\">{record.fechaEvento}</td>\n                    <td className=\"py-3 px-4\">{record.observaciones}</td>\n                    <td className=\"py-3 px-4\">{record.estadoPosterior}</td>\n                    <td className=\"py-3 px-4\">\n                      <button\n                        onClick={() => startEditingHistoryRecord(record)}\n                        className=\"text-blue-600 hover:text-blue-800 font-medium mr-2 transition-colors\"\n                      >\n                        Editar\n                      </button>\n                      <button\n                        onClick={() => handleDeleteHistoryRecord(record.id)}\n                        className=\"text-red-600 hover:text-red-800 font-medium transition-colors\"\n                      >\n                        Eliminar\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n\n          {/* Edit Form for History Record */}\n          {editingRecord && (\n            <div className=\"mt-8 p-6 border rounded-lg bg-yellow-50 shadow-lg\">\n              <h4 className=\"text-lg font-semibold mb-4 text-gray-800\">Editar Registro Histórico: {editingRecord.id}</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-1\">Tipo Evento:</label>\n                  <input\n                    type=\"text\"\n                    name=\"tipoEvento\"\n                    className=\"w-full px-4 py-2 border rounded-lg bg-gray-200 cursor-not-allowed\"\n                    value={editingRecord.tipoEvento}\n                    readOnly\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-1\">Fecha Evento:</label>\n                  <input\n                    type=\"date\"\n                    name=\"fechaEvento\"\n                    className=\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"\n                    value={editingRecord.fechaEvento}\n                    onChange={handleEditingHistoryChange}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-1\">Estado Posterior:</label>\n                  <input\n                    type=\"text\"\n                    name=\"estadoPosterior\"\n                    className=\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"\n                    value={editingRecord.estadoPosterior}\n                    onChange={handleEditingHistoryChange}\n                  />\n                </div>\n                <div className=\"col-span-full\">\n                  <label className=\"block text-gray-700 text-sm font-bold mb-1\">Observaciones:</label>\n                  <textarea\n                    name=\"observaciones\"\n                    rows=\"3\"\n                    className=\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-black\"\n                    value={editingRecord.observaciones}\n                    onChange={handleEditingHistoryChange}\n                  ></textarea>\n                </div>\n              </div>\n              <div className=\"mt-6 flex justify-end space-x-3\">\n                <button\n                  onClick={saveEditedHistoryRecord}\n                  className=\"bg-green-600 text-white py-2 px-5 rounded-lg hover:bg-green-700 transition-colors shadow-md\"\n                >\n                  Guardar Cambios\n                </button>\n                <button\n                  onClick={cancelEditingHistoryRecord}\n                  className=\"bg-gray-600 text-white py-2 px-5 rounded-lg hover:bg-gray-700 transition-colors shadow-md\"\n                >\n                  Cancelar Edición\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Calendario de Gestación y Vacas Preñadas */}\n      <div className=\"mt-8 pt-4 border-t border-gray-200\">\n        <h4 className=\"text-lg font-semibold mb-3\">Vacas Preñadas y Calendario de Gestación</h4>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full bg-white border text-sm\">\n            <thead className=\"bg-gray-100\">\n              <tr>\n                <th className=\"py-2 px-4 border\">ID Vaca</th>\n                <th className=\"py-2 px-4 border\">Nombre</th>\n                <th className=\"py-2 px-4 border\">Fecha Origen Gestación</th>\n                <th className=\"py-2 px-4 border\">Fecha Parto Estimada</th>\n                <th className=\"py-2 px-4 border\">Días Restantes</th>\n                <th className=\"py-2 px-4 border\">Acciones</th>\n              </tr>\n            </thead>\n            <tbody>\n              {pregnantCows.map(vaca => {\n                const diasRestantes = calcularDiasRestantes(vaca.fechaPartoEstimada);\n                const isOverdue = diasRestantes < 0;\n\n                return (\n                  <tr key={vaca.id}>\n                    <td className=\"py-2 px-4 border\">{vaca.id}</td>\n                    <td className=\"py-2 px-4 border\">{vaca.name}</td>\n                    <td className=\"py-2 px-4 border\">{vaca.fechaOrigenGestacion || 'N/A'}</td>\n                    <td className={`py-2 px-4 border ${isOverdue ? 'text-red-600 font-bold' : ''}`}>\n                      {vaca.fechaPartoEstimada || 'N/A'}\n                    </td>\n                    <td className={`py-2 px-4 border ${isOverdue ? 'text-red-600 font-bold' : ''}`}>\n                      {isNaN(diasRestantes) ? 'N/A' : (isOverdue ? `Venció hace ${Math.abs(diasRestantes)} días` : diasRestantes)}\n                    </td>\n                    <td className=\"py-2 px-4 border\">\n                      <button\n                        className=\"text-red-600 hover:underline\"\n                        onClick={() => onDeletePregnantCow(vaca.id)}\n                      >\n                        Eliminar\n                      </button>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ReproductiveControlPage;"],"mappings":"yHAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OAASC,iBAAiB,KAAQ,kBAAkB,CAAE;AACtD,OAASC,WAAW,CAAEC,gBAAgB,KAAQ,wBAAwB,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAExE,KAAM,CAAAC,cAAc,CAAG,GAAG,CAAE;AAE5B,KAAM,CAAAC,uBAAuB,CAAGC,IAAA,EAAkL,IAAjL,CAAEC,OAAO,CAAEC,wBAAwB,CAAEC,2BAA2B,CAAEC,mBAAmB,CAAEC,mBAAmB,CAAEC,sBAAsB,CAAEC,gBAAgB,CAAEC,WAAW,CAAEC,OAAQ,CAAC,CAAAT,IAAA,CAC3M,KAAM,CAACU,cAAc,CAAEC,iBAAiB,CAAC,CAAGzB,QAAQ,CAAC,cAAc,CAAC,CAAE;AAEtE,KAAM,CAAC0B,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG3B,QAAQ,CAAC,CACvD4B,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,EAAE,CACVC,UAAU,CAAE,EAAE,CACdC,aAAa,CAAE,EACjB,CAAC,CAAC,CAEF,KAAM,CAACC,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGjC,QAAQ,CAAC,CACvD4B,MAAM,CAAE,EAAE,CACVM,OAAO,CAAE,EAAE,CAAE;AACbC,iBAAiB,CAAE,EAAE,CACrBC,WAAW,CAAE,EAAE,CACfL,aAAa,CAAE,EACjB,CAAC,CAAC,CAEF,KAAM,CAACM,aAAa,CAAEC,gBAAgB,CAAC,CAAGtC,QAAQ,CAAC,CACjD4B,MAAM,CAAE,EAAE,CACVW,gBAAgB,CAAE,EAAE,CACpBC,oBAAoB,CAAE,EAAE,CAAE;AAC1BC,kBAAkB,CAAE,EAAE,CAAE;AACxBC,cAAc,CAAE,EAAE,CAClBC,WAAW,CAAE,EAAE,CACfC,WAAW,CAAE,EAAE,CACfC,aAAa,CAAE,EAAE,CACjBC,kBAAkB,CAAE,EAAE,CACtBC,cAAc,CAAE,EAAE,CAAE;AACpBC,kBAAkB,CAAE,EAAE,CAAE;AACxBC,gBAAgB,CAAE,EAAE,CAAE;AACtBC,iBAAiB,CAAE,KAAO;AAC5B,CAAC,CAAC,CAEF,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAGpD,QAAQ,CAAC,IAAI,CAAC,CAAE;AAC1D,KAAM,CAAAqD,eAAe,CAAGnD,MAAM,CAAC,IAAI,CAAC,CAAE;AAEtC,KAAM,CAACoD,eAAe,CAAEC,kBAAkB,CAAC,CAAGvD,QAAQ,CAAC,EAAE,CAAC,CAC1D,KAAM,CAACwD,aAAa,CAAEC,gBAAgB,CAAC,CAAGzD,QAAQ,CAAC,EAAE,CAAC,CAEtD;AACA,KAAM,CAAA0D,qBAAqB,CAAIjB,kBAAkB,EAAK,CACpD,KAAM,CAAAkB,GAAG,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CACtB,KAAM,CAAAC,KAAK,CAAG,GAAI,CAAAD,IAAI,CAACnB,kBAAkB,CAAC,CAC1C;AACA,GAAIqB,KAAK,CAACD,KAAK,CAACE,OAAO,CAAC,CAAC,CAAC,CAAE,CAC1B,MAAO,CAAAC,GAAG,CAAE;AACd,CACA,KAAM,CAAAC,UAAU,CAAGJ,KAAK,CAACE,OAAO,CAAC,CAAC,CAAGJ,GAAG,CAACI,OAAO,CAAC,CAAC,CAAE;AACpD,MAAO,CAAAG,IAAI,CAACC,IAAI,CAACF,UAAU,EAAI,IAAI,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAC,CAAC,CACtD,CAAC,CAED;AACAhE,SAAS,CAAC,IAAM,CACd,GAAI,CAACkB,mBAAmB,EAAIA,mBAAmB,CAACiD,MAAM,GAAK,CAAC,CAAE,CAC5D,OACF,CAEA,GAAI,CAAAC,mBAAmB,CAAG,EAAE,CAC5B,GAAI,CAAAC,mBAAmB,CAAG,EAAE,CAE5BnD,mBAAmB,CAACoD,OAAO,CAACC,MAAM,EAAI,CACpC,KAAM,CAAAC,aAAa,CAAG1D,OAAO,CAAC2D,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKJ,MAAM,CAACK,QAAQ,CAAC,CACjE,GAAI,CAACJ,aAAa,CAAE,OAAQ;AAE5B;AACA,GAAID,MAAM,CAACM,UAAU,GAAK,aAAa,EAAIN,MAAM,CAACO,eAAe,GAAK,SAAS,EAAIP,MAAM,CAACQ,MAAM,GAAK,YAAY,CAAE,CACjH,GAAI,CAAAC,qBAAqB,CAAGT,MAAM,CAAC/B,kBAAkB,CAErD;AACA,GAAI,CAACwC,qBAAqB,CAAE,CAC1B,KAAM,CAAAC,aAAa,CAAG,GAAI,CAAAtB,IAAI,CAACY,MAAM,CAACW,WAAW,CAAC,CAClD,GAAID,aAAa,WAAY,CAAAtB,IAAI,EAAI,CAACE,KAAK,CAACoB,aAAa,CAACnB,OAAO,CAAC,CAAC,CAAC,CAAE,CACpE,KAAM,CAAAqB,aAAa,CAAG,GAAI,CAAAxB,IAAI,CAACsB,aAAa,CAAC,CAC7CE,aAAa,CAACC,OAAO,CAACD,aAAa,CAACE,OAAO,CAAC,CAAC,CAAG1E,cAAc,CAAC,CAC/DqE,qBAAqB,CAAGG,aAAa,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACjE;AACAlB,mBAAmB,CAACmB,IAAI,CAAC,CAAEb,EAAE,CAAEJ,MAAM,CAACI,EAAE,CAAEc,MAAM,CAAE,CAAEjD,kBAAkB,CAAEwC,qBAAsB,CAAE,CAAC,CAAC,CACpG,CACF,CAEA,GAAIA,qBAAqB,CAAE,CACzB,KAAM,CAAAU,IAAI,CAAGjC,qBAAqB,CAACuB,qBAAqB,CAAC,CAEzD;AACA,GAAI,CAACnB,KAAK,CAAC6B,IAAI,CAAC,CAAE,CAChB;AACA,GAAIA,IAAI,EAAI,GAAG,EAAIA,IAAI,CAAG,CAAC,EAAIlB,aAAa,CAACmB,kBAAkB,GAAK,MAAM,CAAE,CAC1EvB,mBAAmB,CAACoB,IAAI,CAAC,CAAEb,EAAE,CAAEJ,MAAM,CAACK,QAAQ,CAAEa,MAAM,CAAE,CAAEE,kBAAkB,CAAE,MAAO,CAAE,CAAC,CAAC,CAC3F,CAEA;AACA,GAAID,IAAI,EAAI,CAAC,EAAIlB,aAAa,CAACmB,kBAAkB,GAAK,YAAY,CAAE,CAClEvB,mBAAmB,CAACoB,IAAI,CAAC,CAAEb,EAAE,CAAEJ,MAAM,CAACK,QAAQ,CAAEa,MAAM,CAAE,CAAEE,kBAAkB,CAAE,YAAY,CAAEC,gBAAgB,CAAEZ,qBAAsB,CAAE,CAAC,CAAC,CACxI;AACAX,mBAAmB,CAACmB,IAAI,CAAC,CAAEb,EAAE,CAAEJ,MAAM,CAACI,EAAE,CAAEc,MAAM,CAAE,CAAEV,MAAM,CAAE,YAAa,CAAE,CAAC,CAAC,CAC/E,CACF,CACF,CACF,CACF,CAAC,CAAC,CAEF;AACAX,mBAAmB,CAACE,OAAO,CAACmB,MAAM,EAAI,CACpC1E,wBAAwB,CAAC0E,MAAM,CAACd,EAAE,CAAEc,MAAM,CAACA,MAAM,CAAC,CACpD,CAAC,CAAC,CAEF;AACA,GAAIpB,mBAAmB,CAACF,MAAM,CAAG,CAAC,CAAE,CAClC,KAAM,CAAA0B,sBAAsB,CAAG3E,mBAAmB,CAAC4E,GAAG,CAACC,GAAG,EAAI,CAC5D,KAAM,CAAAN,MAAM,CAAGpB,mBAAmB,CAACI,IAAI,CAACuB,CAAC,EAAIA,CAAC,CAACrB,EAAE,GAAKoB,GAAG,CAACpB,EAAE,CAAC,CAC7D,MAAO,CAAAc,MAAM,CAAAQ,aAAA,CAAAA,aAAA,IAAQF,GAAG,EAAKN,MAAM,CAACA,MAAM,EAAKM,GAAG,CACpD,CAAC,CAAC,CACF5E,sBAAsB,CAAC0E,sBAAsB,CAAC,CAChD,CAEF,CAAC,CAAE,CAAC3E,mBAAmB,CAAEJ,OAAO,CAAEC,wBAAwB,CAAEI,sBAAsB,CAAC,CAAC,CAAE;AAEtF,KAAM,CAAA+E,wBAAwB,CAAIC,CAAC,EAAK,CACtC,KAAM,CAAEC,IAAI,CAAEC,KAAM,CAAC,CAAGF,CAAC,CAACG,MAAM,CAChC5E,mBAAmB,CAAAuE,aAAA,CAAAA,aAAA,IAAMxE,gBAAgB,MAAE,CAAC2E,IAAI,EAAGC,KAAK,EAAE,CAAC,CAC7D,CAAC,CAED,KAAM,CAAAE,wBAAwB,CAAIJ,CAAC,EAAK,CACtC,KAAM,CAAEC,IAAI,CAAEC,KAAM,CAAC,CAAGF,CAAC,CAACG,MAAM,CAChCtE,mBAAmB,CAAAiE,aAAA,CAAAA,aAAA,IAAMlE,gBAAgB,MAAE,CAACqE,IAAI,EAAGC,KAAK,EAAE,CAAC,CAC7D,CAAC,CAED,KAAM,CAAAG,qBAAqB,CAAIL,CAAC,EAAK,CACnC,KAAM,CAAEC,IAAI,CAAEC,KAAK,CAAEI,IAAI,CAAEC,OAAQ,CAAC,CAAGP,CAAC,CAACG,MAAM,CAC/C,GAAI,CAAAK,oBAAoB,CAAAV,aAAA,CAAAA,aAAA,IAAQ7D,aAAa,MAAE,CAACgE,IAAI,EAAGC,KAAK,EAAE,CAE9D,GAAII,IAAI,GAAK,UAAU,CAAE,CACvBE,oBAAoB,CAAAV,aAAA,CAAAA,aAAA,IAAQ7D,aAAa,MAAE,CAACgE,IAAI,EAAGM,OAAO,EAAE,CAC9D,CAAC,IAAM,IAAIN,IAAI,GAAK,kBAAkB,EAAIO,oBAAoB,CAACpE,oBAAoB,GAAK,UAAU,CAAE,CAClG;AACA,KAAM,CAAAqE,gBAAgB,CAAG,GAAI,CAAAjD,IAAI,CAAC0C,KAAK,CAAC,CACxC,GAAIO,gBAAgB,WAAY,CAAAjD,IAAI,EAAI,CAACE,KAAK,CAAC+C,gBAAgB,CAAC9C,OAAO,CAAC,CAAC,CAAC,CAAE,CAC1E,KAAM,CAAAqB,aAAa,CAAG,GAAI,CAAAxB,IAAI,CAACiD,gBAAgB,CAAC,CAChDzB,aAAa,CAACC,OAAO,CAACD,aAAa,CAACE,OAAO,CAAC,CAAC,CAAG1E,cAAc,CAAC,CAC/DgG,oBAAoB,CAACnE,kBAAkB,CAAG2C,aAAa,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACrF,CAAC,IAAM,CACLoB,oBAAoB,CAACnE,kBAAkB,CAAG,EAAE,CAC9C,CACF,CAAC,IAAM,IAAI4D,IAAI,GAAK,sBAAsB,EAAIC,KAAK,GAAK,UAAU,EAAIM,oBAAoB,CAACrE,gBAAgB,CAAE,CAC3G;AACA,KAAM,CAAAsE,gBAAgB,CAAG,GAAI,CAAAjD,IAAI,CAACgD,oBAAoB,CAACrE,gBAAgB,CAAC,CACxE,GAAIsE,gBAAgB,WAAY,CAAAjD,IAAI,EAAI,CAACE,KAAK,CAAC+C,gBAAgB,CAAC9C,OAAO,CAAC,CAAC,CAAC,CAAE,CAC1E,KAAM,CAAAqB,aAAa,CAAG,GAAI,CAAAxB,IAAI,CAACiD,gBAAgB,CAAC,CAChDzB,aAAa,CAACC,OAAO,CAACD,aAAa,CAACE,OAAO,CAAC,CAAC,CAAG1E,cAAc,CAAC,CAC/DgG,oBAAoB,CAACnE,kBAAkB,CAAG2C,aAAa,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACrF,CAAC,IAAM,CACLoB,oBAAoB,CAACnE,kBAAkB,CAAG,EAAE,CAC9C,CACF,CAAC,IAAM,IAAI4D,IAAI,GAAK,sBAAsB,EAAIC,KAAK,GAAK,UAAU,CAAE,CAClE;AACAM,oBAAoB,CAACnE,kBAAkB,CAAG,EAAE,CAC9C,CAEAH,gBAAgB,CAACsE,oBAAoB,CAAC,CACxC,CAAC,CAED,KAAM,CAAAE,wBAAwB,CAAGA,CAAA,GAAM,CACrC,KAAM,CAAElF,MAAM,CAAEC,MAAM,CAAEC,UAAU,CAAEC,aAAc,CAAC,CAAGL,gBAAgB,CAEtE,GAAI,CAACE,MAAM,EAAI,CAACC,MAAM,EAAI,CAACC,UAAU,CAAE,CACrCiF,KAAK,CAAC,gIAAgI,CAAC,CACvI,OACF,CAEA;AACA,KAAM,CAAAC,YAAY,CAAG,GAAI,CAAApD,IAAI,CAAC9B,UAAU,CAAC,CACzC,GAAI,CAAAmF,2BAA2B,CAAG,EAAE,CACpC,GAAID,YAAY,WAAY,CAAApD,IAAI,EAAI,CAACE,KAAK,CAACkD,YAAY,CAACjD,OAAO,CAAC,CAAC,CAAC,CAAE,CAClE,KAAM,CAAAqB,aAAa,CAAG,GAAI,CAAAxB,IAAI,CAACoD,YAAY,CAAC,CAC5C5B,aAAa,CAACC,OAAO,CAACD,aAAa,CAACE,OAAO,CAAC,CAAC,CAAG1E,cAAc,CAAC,CAC/DqG,2BAA2B,CAAG7B,aAAa,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACzE,CAEAvE,2BAA2B,CAAC,CAC1B2D,EAAE,QAAAsC,MAAA,CAAStD,IAAI,CAACuD,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAE,CAAE;AAC9CxC,QAAQ,CAAEjD,MAAM,CAChBkD,UAAU,CAAE,OAAO,CACnBK,WAAW,CAAErD,UAAU,CACvBC,aAAa,CACbgD,eAAe,CAAE,sBAAsB,CAAE;AACzClD,MAAM,CACNY,kBAAkB,CAAEwE,2BAA6B;AACnD,CAAC,CAAC,CAEFF,KAAK,CAAC,4GAA4G,CAAC,CACnHpF,mBAAmB,CAAC,CAAEC,MAAM,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAE,CAAEC,UAAU,CAAE,EAAE,CAAEC,aAAa,CAAE,EAAG,CAAC,CAAC,CACpF,CAAC,CAED,KAAM,CAAAuF,wBAAwB,CAAGA,CAAA,GAAM,CACrC,KAAM,CAAE1F,MAAM,CAAEM,OAAO,CAAEC,iBAAiB,CAAEJ,aAAc,CAAC,CAAGC,gBAAgB,CAE9E,GAAI,CAACJ,MAAM,EAAI,CAACM,OAAO,EAAI,CAACC,iBAAiB,CAAE,CAC7C4E,KAAK,CAAC,iHAAiH,CAAC,CACxH,OACF,CAEA;AACA,KAAM,CAAAQ,mBAAmB,CAAG,GAAI,CAAA3D,IAAI,CAACzB,iBAAiB,CAAC,CACvD,GAAI,CAAA8E,2BAA2B,CAAG,EAAE,CACpC,GAAIM,mBAAmB,WAAY,CAAA3D,IAAI,EAAI,CAACE,KAAK,CAACyD,mBAAmB,CAACxD,OAAO,CAAC,CAAC,CAAC,CAAE,CAChF,KAAM,CAAAqB,aAAa,CAAG,GAAI,CAAAxB,IAAI,CAAC2D,mBAAmB,CAAC,CACnDnC,aAAa,CAACC,OAAO,CAACD,aAAa,CAACE,OAAO,CAAC,CAAC,CAAG1E,cAAc,CAAC,CAC/DqG,2BAA2B,CAAG7B,aAAa,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACzE,CAEAvE,2BAA2B,CAAC,CAC1B2D,EAAE,QAAAsC,MAAA,CAAStD,IAAI,CAACuD,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAE,CAAE;AAC9CxC,QAAQ,CAAEjD,MAAM,CAChBkD,UAAU,CAAE,cAAc,CAC1BK,WAAW,CAAEhD,iBAAiB,CAC9BJ,aAAa,CACbgD,eAAe,CAAE,sBAAsB,CAAE;AACzClD,MAAM,CAAEK,OAAO,CAAE;AACjBO,kBAAkB,CAAEwE,2BAA6B;AACnD,CAAC,CAAC,CAEFF,KAAK,CAAC,yFAAyF,CAAC,CAEhG9E,mBAAmB,CAAC,CAClBL,MAAM,CAAE,EAAE,CACVM,OAAO,CAAE,EAAE,CACXC,iBAAiB,CAAE,EAAE,CACrBJ,aAAa,CAAE,EACjB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAyF,qBAAqB,CAAGA,CAAA,GAAM,CAClC,KAAM,CACJ5F,MAAM,CACNW,gBAAgB,CAChBC,oBAAoB,CACpBG,WAAW,CACXC,WAAW,CACXC,aAAa,CACbC,kBAAkB,CAClBJ,cAAc,CACdK,cAAc,CACdC,kBAAkB,CAClBC,gBAAgB,CAChBC,iBAAiB,CACjBT,kBAAmB;AACrB,CAAC,CAAGJ,aAAa,CAEjB,GAAI,CAACT,MAAM,EAAI,CAACW,gBAAgB,EAAI,CAACC,oBAAoB,CAAE,CACzDuE,KAAK,CAAC,oHAAoH,CAAC,CAC3H,OACF,CAEA,GAAI,CAAAU,cAAc,CAAG,EAAE,CAEvB,GAAIjF,oBAAoB,GAAK,UAAU,CAAE,CACvCiF,cAAc,CAAG,SAAS,CAC5B,CAAC,IAAM,CACLA,cAAc,CAAG,OAAO,CAC1B,CAEA;AACAzG,wBAAwB,CAACY,MAAM,CAAE,CAC/BgE,kBAAkB,CAAE6B,cAAc,CAClCC,oBAAoB,CAAED,cAAc,GAAK,SAAS,CAAGlF,gBAAgB,CAAG,EAC1E,CAAC,CAAC,CAEF;AACAtB,2BAA2B,CAAC,CAC1B2D,EAAE,QAAAsC,MAAA,CAAStD,IAAI,CAACuD,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAE,CAC5CxC,QAAQ,CAAEjD,MAAM,CAChBkD,UAAU,CAAE,aAAa,CACzBK,WAAW,CAAE5C,gBAAgB,CAC7BR,aAAa,oBAAAmF,MAAA,CAAkB1E,oBAAoB,OAAA0E,MAAA,CAAKpE,kBAAkB,CAAE,CAC5EiC,eAAe,CAAE0C,cAAc,CAC/BhF,kBAAkB,CAAEA,kBAAoB;AAC1C,CAAC,CAAC,CAEF;AACA,GAAIC,cAAc,CAAE,CAClB1B,wBAAwB,CAACY,MAAM,CAAE,CAC/BgE,kBAAkB,CAAE,YAAY,CAChCC,gBAAgB,CAAEnD,cACpB,CAAC,CAAC,CAEFzB,2BAA2B,CAAC,CAC1B2D,EAAE,QAAAsC,MAAA,CAAStD,IAAI,CAACuD,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAE,CAC5CxC,QAAQ,CAAEjD,MAAM,CAChBkD,UAAU,CAAE,OAAO,CACnBK,WAAW,CAAEzC,cAAc,CAC3BX,aAAa,CAAEe,kBAAkB,CACjCiC,eAAe,CAAE,YACnB,CAAC,CAAC,CAEF,GAAIlC,aAAa,EAAID,WAAW,EAAID,WAAW,CAAE,KAAAgF,aAAA,CAAAC,cAAA,CAC/C,KAAM,CAAAC,SAAS,CAAG,GAAI,CAAAjE,IAAI,CAAClB,cAAc,CAAC,CAACoF,WAAW,CAAC,CAAC,CAACV,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC7E,KAAM,CAAAU,SAAS,IAAAb,MAAA,CAAMtF,MAAM,MAAAsF,MAAA,CAAIW,SAAS,CAAE,CAE1C,KAAM,CAAAG,OAAO,CAAG,CACdpD,EAAE,CAAEmD,SAAS,CACb1B,IAAI,CAAExD,aAAa,CACnBoF,IAAI,CAAE,EAAAN,aAAA,CAAA5G,OAAO,CAAC2D,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKhD,MAAM,CAAC,UAAA+F,aAAA,iBAAlCA,aAAA,CAAoCM,IAAI,GAAI,aAAa,CAC/DC,IAAI,CAAEvF,WAAW,CACjBwF,IAAI,CAAEvF,WAAW,CACjBwF,eAAe,CAAE1F,cAAc,CAC/B2F,WAAW,CAAE,EAAE,CACfC,cAAc,CAAE,EAAE,CAClBC,OAAO,CAAErF,iBAAiB,CAAGH,cAAc,CAAGC,kBAAkB,CAChEwF,SAAS,CAAEtF,iBAAiB,CAAG,EAAA0E,cAAA,CAAA7G,OAAO,CAAC2D,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAK7B,cAAc,CAAC,UAAA6E,cAAA,iBAA1CA,cAAA,CAA4CK,IAAI,GAAI,aAAa,CAAGhF,gBAAgB,CACnHwF,OAAO,CAAE7G,MAAM,CACfgE,kBAAkB,CAAE,YAAY,CAChC8C,eAAe,CAAEvI,iBAAiB,CAACuC,cAAc,CAAEE,WAAW,CAChE,CAAC,CACDvB,gBAAgB,CAAC2G,OAAO,CAAC,CACzBjB,KAAK,gCAAAG,MAAA,CAA6BrE,aAAa,oDAAAqE,MAAA,CAA+Ca,SAAS,yCAAoC,CAAC,CAC9I,CACF,CAEAhB,KAAK,CAAC,2EAA2E,CAAC,CAClFzE,gBAAgB,CAAC,CACfV,MAAM,CAAE,EAAE,CACVW,gBAAgB,CAAE,EAAE,CACpBC,oBAAoB,CAAE,EAAE,CACxBC,kBAAkB,CAAE,EAAE,CACtBE,WAAW,CAAE,EAAE,CACfC,WAAW,CAAE,EAAE,CACfC,aAAa,CAAE,EAAE,CACjBC,kBAAkB,CAAE,EAAE,CACtBJ,cAAc,CAAE,EAAE,CAClBK,cAAc,CAAE,EAAE,CAClBC,kBAAkB,CAAE,EAAE,CACtBC,gBAAgB,CAAE,EAAE,CACpBC,iBAAiB,CAAE,KACrB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAyF,yBAAyB,CAAIC,QAAQ,EAAK,CAC9C,GAAIC,MAAM,CAACC,OAAO,CAAC,yFAAyF,CAAC,CAAE,CAC7G,KAAM,CAAAC,cAAc,CAAG5H,mBAAmB,CAAC6H,MAAM,CAACxE,MAAM,EAAIA,MAAM,CAACI,EAAE,GAAKgE,QAAQ,CAAC,CACnFxH,sBAAsB,CAAC2H,cAAc,CAAC,CAAE;AACxChC,KAAK,CAAC,sDAAsD,CAAC,CAC/D,CACF,CAAC,CAED,KAAM,CAAAkC,yBAAyB,CAAIzE,MAAM,EAAK,CAC5CpB,gBAAgB,CAAA8C,aAAA,IAAM1B,MAAM,CAAE,CAAC,CAAE;AACjCuC,KAAK,CAAC,kEAAkE,CAAC,CAC3E,CAAC,CAED,KAAM,CAAAmC,0BAA0B,CAAI9C,CAAC,EAAK,CACxC,KAAM,CAAEC,IAAI,CAAEC,KAAM,CAAC,CAAGF,CAAC,CAACG,MAAM,CAChCnD,gBAAgB,CAAC+F,IAAI,EAAAjD,aAAA,CAAAA,aAAA,IAAUiD,IAAI,MAAE,CAAC9C,IAAI,EAAGC,KAAK,EAAG,CAAC,CACxD,CAAC,CAED,KAAM,CAAA8C,uBAAuB,CAAGA,CAAA,GAAM,CACpC,KAAM,CAAAL,cAAc,CAAG5H,mBAAmB,CAAC4E,GAAG,CAACvB,MAAM,EACnDA,MAAM,CAACI,EAAE,GAAKzB,aAAa,CAACyB,EAAE,CAAGzB,aAAa,CAAGqB,MACnD,CAAC,CACDpD,sBAAsB,CAAC2H,cAAc,CAAC,CAAE;AACxC3F,gBAAgB,CAAC,IAAI,CAAC,CAAE;AACxB2D,KAAK,CAAC,+CAA+C,CAAC,CACxD,CAAC,CAED,KAAM,CAAAsC,0BAA0B,CAAGA,CAAA,GAAM,CACvCjG,gBAAgB,CAAC,IAAI,CAAC,CAAE;AACxB2D,KAAK,CAAC,+DAA+D,CAAC,CACxE,CAAC,CAED;AACA,KAAM,CAAAuC,oBAAoB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAAAC,QAAQ,CAAGC,MAAM,CAAC,iDAAiD,CAAC,CAC1E,KAAM,CAAA1E,UAAU,CAAG0E,MAAM,CAAC,4EAA4E,CAAC,CACvG,KAAM,CAAArE,WAAW,CAAGqE,MAAM,CAAC,0CAA0C,CAAC,CACtE,KAAM,CAAAzH,aAAa,CAAGyH,MAAM,CAAC,mDAAmD,CAAC,CACjF,KAAM,CAAAzE,eAAe,CAAGyE,MAAM,CAAC,oFAAoF,CAAC,CAEpH,GAAID,QAAQ,EAAIzE,UAAU,EAAIK,WAAW,CAAE,CACzClE,2BAA2B,CAAC,CAC1B2D,EAAE,QAAAsC,MAAA,CAAStD,IAAI,CAACuD,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAE,CAAE;AAC9CxC,QAAQ,CAAE0E,QAAQ,CAClBzE,UAAU,CAAEA,UAAU,CACtBK,WAAW,CAAEA,WAAW,CACxBpD,aAAa,CAAEA,aAAa,CAC5BgD,eAAe,CAAEA,eACnB,CAAC,CAAC,CACFgC,KAAK,CAAC,0DAA0D,CAAC,CACnE,CAAC,IAAM,CACLA,KAAK,CAAC,yHAAyH,CAAC,CAClI,CACF,CAAC,CAED,KAAM,CAAA0C,mBAAmB,CAAG,KAAO,CAAAC,MAAM,EAAK,CAC5C,GAAIvI,mBAAmB,CAACiD,MAAM,GAAK,CAAC,CAAE,CACpC2C,KAAK,CAAC,yEAAyE,CAAC,CAChF,OACF,CAEA,KAAM,CAAA4C,QAAQ,2BAAAzC,MAAA,CAA6B,GAAI,CAAAtD,IAAI,CAAC,CAAC,CAAC2B,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAE,CACnF,KAAM,CAAAoE,QAAQ,CAAG,CAAAtI,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEsI,QAAQ,GAAI,mBAAmB,CAC7D,KAAM,CAAAC,SAAS,CAAG,CAAAvI,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEwI,QAAQ,GAAI,eAAe,CAE1D,GAAIJ,MAAM,GAAK,KAAK,CAAE,CACpBtJ,WAAW,CAACe,mBAAmB,CAAEwI,QAAQ,CAAC,CAC1C5C,KAAK,CAAC,+DAA+D,CAAC,CACxE,CAAC,IAAM,IAAI2C,MAAM,GAAK,KAAK,CAAE,CAC3B,KAAM,CAAArJ,gBAAgB,CAACgD,eAAe,CAAC0G,OAAO,CAAEJ,QAAQ,CAAE,wBAAwB,CAAEC,QAAQ,CAAEC,SAAS,CAAEtI,OAAO,CAAC,CACjHwF,KAAK,CAAC,wDAAwD,CAAC,CACjE,CACF,CAAC,CAED;AACA,KAAM,CAAAiD,YAAY,CAAGjJ,OAAO,CAACiI,MAAM,CAACiB,MAAM,EACxCA,MAAM,CAAC9B,IAAI,GAAK,QAAQ,EAAI8B,MAAM,CAACrE,kBAAkB,GAAK,SAC5D,CAAC,CAACG,GAAG,CAACkE,MAAM,EAAI,CACd;AACA,KAAM,CAAAC,qBAAqB,CAAG/I,mBAAmB,CAC9C6H,MAAM,CAAChD,GAAG,EAAIA,GAAG,CAACnB,QAAQ,GAAKoF,MAAM,CAACrF,EAAE,EAAIoB,GAAG,CAAClB,UAAU,GAAK,aAAa,EAAIkB,GAAG,CAACjB,eAAe,GAAK,SAAS,CAAC,CAClHoF,IAAI,CAAC,CAACxF,CAAC,CAAEyF,CAAC,GAAK,GAAI,CAAAxG,IAAI,CAACwG,CAAC,CAACjF,WAAW,CAAC,CAAG,GAAI,CAAAvB,IAAI,CAACe,CAAC,CAACQ,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAEvE,KAAM,CAAAkF,qBAAqB,CAAGlJ,mBAAmB,CAC9C6H,MAAM,CAAChD,GAAG,EAAIA,GAAG,CAACnB,QAAQ,GAAKoF,MAAM,CAACrF,EAAE,GAAKoB,GAAG,CAAClB,UAAU,GAAK,OAAO,EAAIkB,GAAG,CAAClB,UAAU,GAAK,cAAc,CAAC,CAAC,CAC9GqF,IAAI,CAAC,CAACxF,CAAC,CAAEyF,CAAC,GAAK,GAAI,CAAAxG,IAAI,CAACwG,CAAC,CAACjF,WAAW,CAAC,CAAG,GAAI,CAAAvB,IAAI,CAACe,CAAC,CAACQ,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAEvE,GAAI,CAAAmF,oBAAoB,CAAG,EAAE,CAC7B,GAAI,CAAA7H,kBAAkB,CAAG,EAAE,CAE3B,GAAIyH,qBAAqB,EAAIA,qBAAqB,CAACzH,kBAAkB,CAAE,CACrE6H,oBAAoB,CAAGJ,qBAAqB,CAAC/E,WAAW,CACxD1C,kBAAkB,CAAGyH,qBAAqB,CAACzH,kBAAkB,CAC/D,CAAC,IAAM,IAAI4H,qBAAqB,CAAE,CAChCC,oBAAoB,CAAGD,qBAAqB,CAAClF,WAAW,CACxD,KAAM,CAAAoF,aAAa,CAAG,GAAI,CAAA3G,IAAI,CAAC0G,oBAAoB,CAAC,CACpD,GAAIC,aAAa,WAAY,CAAA3G,IAAI,EAAI,CAACE,KAAK,CAACyG,aAAa,CAACxG,OAAO,CAAC,CAAC,CAAC,CAAE,CACpE,KAAM,CAAAqB,aAAa,CAAG,GAAI,CAAAxB,IAAI,CAAC2G,aAAa,CAAC,CAC7CnF,aAAa,CAACC,OAAO,CAACD,aAAa,CAACE,OAAO,CAAC,CAAC,CAAG1E,cAAc,CAAC,CAC/D6B,kBAAkB,CAAG2C,aAAa,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAChE,CACF,CAEA,OAAAU,aAAA,CAAAA,aAAA,IACK+D,MAAM,MACTK,oBAAoB,CAAEA,oBAAoB,CAC1C7H,kBAAkB,CAAEA,kBAAkB,GAE1C,CAAC,CAAC,CAACuG,MAAM,CAACiB,MAAM,EAAIA,MAAM,CAACxH,kBAAkB,CAAC,CAAE;AAEhD,KAAM,CAAA+H,2BAA2B,CAAGrJ,mBAAmB,CAAC6H,MAAM,CAACxE,MAAM,EAAI,CACvE,KAAM,CAAAiG,UAAU,CAAG,GAAI,CAAA7G,IAAI,CAACY,MAAM,CAACW,WAAW,CAAC,CAC/C,KAAM,CAAAuF,KAAK,CAAGpH,eAAe,CAAG,GAAI,CAAAM,IAAI,CAACN,eAAe,CAAC,CAAG,IAAI,CAChE,KAAM,CAAAqH,GAAG,CAAGnH,aAAa,CAAG,GAAI,CAAAI,IAAI,CAACJ,aAAa,CAAC,CAAG,IAAI,CAE1D,GAAIkH,KAAK,EAAID,UAAU,CAAGC,KAAK,CAAE,MAAO,MAAK,CAC7C,GAAIC,GAAG,EAAIF,UAAU,CAAGE,GAAG,CAAE,MAAO,MAAK,CACzC,MAAO,KAAI,CACb,CAAC,CAAC,CAEF,KAAM,CAAAC,WAAW,CAAG7J,OAAO,CAACiI,MAAM,CAACrE,CAAC,EAAIA,CAAC,CAACwD,IAAI,GAAK,OAAO,CAAC,CAE3D,mBACE1H,KAAA,QAAKoK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,eAChDvK,IAAA,OAAIsK,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,sBAAoB,CAAI,CAAC,cAEpErK,KAAA,QAAKoK,SAAS,CAAC,oCAAoC,CAAAC,QAAA,eACjDvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMtJ,iBAAiB,CAAC,cAAc,CAAE,CACjDoJ,SAAS,yBAAA3D,MAAA,CAA0B1F,cAAc,GAAK,cAAc,CAAG,wBAAwB,CAAG,2BAA2B,wCAAuC,CAAAsJ,QAAA,CACrK,eAED,CAAQ,CAAC,cACTvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMtJ,iBAAiB,CAAC,cAAc,CAAE,CACjDoJ,SAAS,yBAAA3D,MAAA,CAA0B1F,cAAc,GAAK,cAAc,CAAG,wBAAwB,CAAG,2BAA2B,wCAAuC,CAAAsJ,QAAA,CACrK,iBAED,CAAQ,CAAC,cACTvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMtJ,iBAAiB,CAAC,WAAW,CAAE,CAC9CoJ,SAAS,yBAAA3D,MAAA,CAA0B1F,cAAc,GAAK,WAAW,CAAG,wBAAwB,CAAG,2BAA2B,wCAAuC,CAAAsJ,QAAA,CAClK,iCAED,CAAQ,CAAC,cACTvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMtJ,iBAAiB,CAAC,WAAW,CAAE,CAC9CoJ,SAAS,yBAAA3D,MAAA,CAA0B1F,cAAc,GAAK,WAAW,CAAG,wBAAwB,CAAG,2BAA2B,wCAAuC,CAAAsJ,QAAA,CAClK,wBAED,CAAQ,CAAC,EACN,CAAC,CAELtJ,cAAc,GAAK,cAAc,eAChCf,KAAA,QAAKoK,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/CvK,IAAA,OAAIsK,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,2BAAyB,CAAI,CAAC,cACzErK,KAAA,QAAKoK,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,OAAK,CAAO,CAAC,cAC3ErK,KAAA,WACE4F,IAAI,CAAC,QAAQ,CACbwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAE5E,gBAAgB,CAACE,MAAO,CAC/BoJ,QAAQ,CAAE7E,wBAAyB,CAAA2E,QAAA,eAEnCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,iBAAe,CAAQ,CAAC,CACxC/J,OAAO,CAACiI,MAAM,CAACrE,CAAC,EAAIA,CAAC,CAACwD,IAAI,GAAK,QAAQ,CAAC,CAACpC,GAAG,CAACkF,IAAI,eAChDxK,KAAA,WAAsB6F,KAAK,CAAE2E,IAAI,CAACrG,EAAG,CAAAkG,QAAA,EAAEG,IAAI,CAAC5E,IAAI,CAAC,IAAE,CAAC4E,IAAI,CAACrG,EAAE,CAAC,GAAC,GAAhDqG,IAAI,CAACrG,EAAmD,CACtE,CAAC,EACI,CAAC,cACTrE,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,OAAK,CAAO,CAAC,cAC3ErK,KAAA,WACE4F,IAAI,CAAC,QAAQ,CACbwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAE5E,gBAAgB,CAACG,MAAO,CAC/BmJ,QAAQ,CAAE7E,wBAAyB,CAAA2E,QAAA,eAEnCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,iBAAe,CAAQ,CAAC,CACxC/J,OAAO,CAACiI,MAAM,CAACrE,CAAC,EAAIA,CAAC,CAACwD,IAAI,GAAK,OAAO,CAAC,CAACpC,GAAG,CAACmF,IAAI,eAC/CzK,KAAA,WAAsB6F,KAAK,CAAE4E,IAAI,CAACtG,EAAG,CAAAkG,QAAA,EAAEI,IAAI,CAAC7E,IAAI,CAAC,IAAE,CAAC6E,IAAI,CAACtG,EAAE,CAAC,GAAC,GAAhDsG,IAAI,CAACtG,EAAmD,CACtE,CAAC,EACI,CAAC,cACTrE,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,iBAAe,CAAO,CAAC,cACrFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,YAAY,CACjB8E,WAAW,CAAC,gBAAgB,CAC5BN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAE5E,gBAAgB,CAACI,UAAW,CACnCkJ,QAAQ,CAAE7E,wBAAyB,CACpC,CAAC,cACF5F,IAAA,UAAOsK,SAAS,CAAC,0DAA0D,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cAClGvK,IAAA,aACE8F,IAAI,CAAC,eAAe,CACpB8E,WAAW,CAAC,eAAe,CAC3BC,IAAI,CAAC,GAAG,CACRP,SAAS,CAAC,kDAAkD,CAC5DvE,KAAK,CAAE5E,gBAAgB,CAACK,aAAc,CACtCiJ,QAAQ,CAAE7E,wBAAyB,CAC1B,CAAC,EACT,CAAC,cACN5F,IAAA,WACEwK,OAAO,CAAEjE,wBAAyB,CAClC+D,SAAS,CAAC,mFAAmF,CAAAC,QAAA,CAC9F,iBAED,CAAQ,CAAC,EACN,CACN,CAEAtJ,cAAc,GAAK,cAAc,eAChCf,KAAA,QAAKoK,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/CvK,IAAA,OAAIsK,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,6BAAwB,CAAI,CAAC,cACxErK,KAAA,QAAKoK,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,OAAK,CAAO,CAAC,cAC3ErK,KAAA,WACE4F,IAAI,CAAC,QAAQ,CACbwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEtE,gBAAgB,CAACJ,MAAO,CAC/BoJ,QAAQ,CAAExE,wBAAyB,CAAAsE,QAAA,eAEnCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,iBAAe,CAAQ,CAAC,CACxC/J,OAAO,CAACiI,MAAM,CAACrE,CAAC,EAAIA,CAAC,CAACwD,IAAI,GAAK,QAAQ,CAAC,CAACpC,GAAG,CAACkF,IAAI,eAChDxK,KAAA,WAAsB6F,KAAK,CAAE2E,IAAI,CAACrG,EAAG,CAAAkG,QAAA,EAAEG,IAAI,CAAC5E,IAAI,CAAC,IAAE,CAAC4E,IAAI,CAACrG,EAAE,CAAC,GAAC,GAAhDqG,IAAI,CAACrG,EAAmD,CACtE,CAAC,EACI,CAAC,cACTrE,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,qBAAmB,CAAO,CAAC,cACzFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,SAAS,CACd8E,WAAW,CAAC,oBAAoB,CAChCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEtE,gBAAgB,CAACE,OAAQ,CAChC8I,QAAQ,CAAExE,wBAAyB,CACpC,CAAC,cACFjG,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,2BAAsB,CAAO,CAAC,cAC5FvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,mBAAmB,CACxB8E,WAAW,CAAC,0BAAuB,CACnCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEtE,gBAAgB,CAACG,iBAAkB,CAC1C6I,QAAQ,CAAExE,wBAAyB,CACpC,CAAC,cACFjG,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,cAAY,CAAO,CAAC,cAClFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,aAAa,CAClB8E,WAAW,CAAC,wBAAwB,CACpCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEtE,gBAAgB,CAACI,WAAY,CACpC4I,QAAQ,CAAExE,wBAAyB,CACpC,CAAC,cACFjG,IAAA,UAAOsK,SAAS,CAAC,0DAA0D,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cAClGvK,IAAA,aACE8F,IAAI,CAAC,eAAe,CACpB8E,WAAW,CAAC,eAAe,CAC3BC,IAAI,CAAC,GAAG,CACRP,SAAS,CAAC,kDAAkD,CAC5DvE,KAAK,CAAEtE,gBAAgB,CAACD,aAAc,CACtCiJ,QAAQ,CAAExE,wBAAyB,CAC1B,CAAC,EACT,CAAC,cACNjG,IAAA,WACEwK,OAAO,CAAEzD,wBAAyB,CAClCuD,SAAS,CAAC,mFAAmF,CAAAC,QAAA,CAC9F,2BAED,CAAQ,CAAC,EACN,CACN,CAEAtJ,cAAc,GAAK,WAAW,eAC7Bf,KAAA,QAAKoK,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/CvK,IAAA,OAAIsK,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,iCAA4B,CAAI,CAAC,cAC5ErK,KAAA,QAAKoK,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,OAAK,CAAO,CAAC,cAC3ErK,KAAA,WACE4F,IAAI,CAAC,QAAQ,CACbwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACT,MAAO,CAC5BoJ,QAAQ,CAAEvE,qBAAsB,CAAAqE,QAAA,eAEhCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,iBAAe,CAAQ,CAAC,CACxC/J,OAAO,CAACiI,MAAM,CAACrE,CAAC,EAAIA,CAAC,CAACwD,IAAI,GAAK,QAAQ,CAAC,CAACpC,GAAG,CAACkF,IAAI,eAChDxK,KAAA,WAAsB6F,KAAK,CAAE2E,IAAI,CAACrG,EAAG,CAAAkG,QAAA,EAAEG,IAAI,CAAC5E,IAAI,CAAC,IAAE,CAAC4E,IAAI,CAACrG,EAAE,CAAC,GAAC,GAAhDqG,IAAI,CAACrG,EAAmD,CACtE,CAAC,EACI,CAAC,cACTrE,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,oCAA4B,CAAO,CAAC,cAClGvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,kBAAkB,CACvB8E,WAAW,CAAC,yCAAmC,CAC/CN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACE,gBAAiB,CACtCyI,QAAQ,CAAEvE,qBAAsB,CACjC,CAAC,cACFlG,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,2BAAsB,CAAO,CAAC,cAC5FrK,KAAA,WACE4F,IAAI,CAAC,sBAAsB,CAC3BwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACG,oBAAqB,CAC1CwI,QAAQ,CAAEvE,qBAAsB,CAAAqE,QAAA,eAEhCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,0BAAqB,CAAQ,CAAC,cAC/CvK,IAAA,WAAQ+F,KAAK,CAAC,UAAU,CAAAwE,QAAA,CAAC,uBAAkB,CAAQ,CAAC,cACpDvK,IAAA,WAAQ+F,KAAK,CAAC,UAAU,CAAAwE,QAAA,CAAC,UAAQ,CAAQ,CAAC,EACpC,CAAC,CACRzI,aAAa,CAACG,oBAAoB,GAAK,UAAU,eAChD/B,KAAA,CAAAE,SAAA,EAAAmK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,0BAAwB,CAAO,CAAC,cAC9FvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,oBAAoB,CACzB8E,WAAW,CAAC,yBAAyB,CACrCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACI,kBAAmB,CACxCuI,QAAQ,CAAEvE,qBAAsB,CAChC4E,KAAK,CAAC,2FAAkF,CACzF,CAAC,EACF,CACH,cACD9K,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,yCAAoC,CAAO,CAAC,cAC1GvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,gBAAgB,CACrB8E,WAAW,CAAC,wCAAqC,CACjDN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACK,cAAe,CACpCsI,QAAQ,CAAEvE,qBAAsB,CACjC,CAAC,CACDpE,aAAa,CAACK,cAAc,eAC3BjC,KAAA,CAAAE,SAAA,EAAAmK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,wBAAsB,CAAO,CAAC,cAC5FvK,IAAA,UACEmG,IAAI,CAAC,QAAQ,CACbL,IAAI,CAAC,aAAa,CAClB8E,WAAW,CAAC,uBAAuB,CACnCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACM,WAAY,CACjCqI,QAAQ,CAAEvE,qBAAsB,CACjC,CAAC,cACFlG,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,mBAAiB,CAAO,CAAC,cACvFrK,KAAA,WACE4F,IAAI,CAAC,aAAa,CAClBwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACO,WAAY,CACjCoI,QAAQ,CAAEvE,qBAAsB,CAAAqE,QAAA,eAEhCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,kBAAgB,CAAQ,CAAC,cAC1CvK,IAAA,WAAQ+F,KAAK,CAAC,OAAO,CAAAwE,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpCvK,IAAA,WAAQ+F,KAAK,CAAC,QAAQ,CAAAwE,QAAA,CAAC,QAAM,CAAQ,CAAC,EAChC,CAAC,cACTvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,qBAAmB,CAAO,CAAC,cACzFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,eAAe,CACpB8E,WAAW,CAAC,oBAAoB,CAChCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACQ,aAAc,CACnCmI,QAAQ,CAAEvE,qBAAsB,CACjC,CAAC,cAEFhG,KAAA,QAAKoK,SAAS,CAAC,2CAA2C,CAAAC,QAAA,eACxDvK,IAAA,UACEmG,IAAI,CAAC,UAAU,CACf9B,EAAE,CAAC,mBAAmB,CACtByB,IAAI,CAAC,mBAAmB,CACxBM,OAAO,CAAEtE,aAAa,CAACa,iBAAkB,CACzC8H,QAAQ,CAAEvE,qBAAsB,CAChCoE,SAAS,CAAC,qCAAqC,CAChD,CAAC,cACFtK,IAAA,UAAO+K,OAAO,CAAC,mBAAmB,CAACT,SAAS,CAAC,iCAAiC,CAAAC,QAAA,CAAC,8BAA4B,CAAO,CAAC,EAChH,CAAC,CAELzI,aAAa,CAACa,iBAAiB,cAC9BzC,KAAA,CAAAE,SAAA,EAAAmK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,oBAAkB,CAAO,CAAC,cACxFrK,KAAA,WACE4F,IAAI,CAAC,gBAAgB,CACrBwE,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACU,cAAe,CACpCiI,QAAQ,CAAEvE,qBAAsB,CAAAqE,QAAA,eAEhCvK,IAAA,WAAQ+F,KAAK,CAAC,EAAE,CAAAwE,QAAA,CAAC,kBAAgB,CAAQ,CAAC,CACzCF,WAAW,CAAC7E,GAAG,CAACmF,IAAI,eACnBzK,KAAA,WAAsB6F,KAAK,CAAE4E,IAAI,CAACtG,EAAG,CAAAkG,QAAA,EAAEI,IAAI,CAAC7E,IAAI,CAAC,IAAE,CAAC6E,IAAI,CAACtG,EAAE,CAAC,GAAC,GAAhDsG,IAAI,CAACtG,EAAmD,CACtE,CAAC,EACI,CAAC,EACT,CAAC,cAEHnE,KAAA,CAAAE,SAAA,EAAAmK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,+BAA6B,CAAO,CAAC,cACnGvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,oBAAoB,CACzB8E,WAAW,CAAC,8BAA8B,CAC1CN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACW,kBAAmB,CACxCgI,QAAQ,CAAEvE,qBAAsB,CACjC,CAAC,cACFlG,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,6BAA2B,CAAO,CAAC,cACjGvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,kBAAkB,CACvB8E,WAAW,CAAC,4BAA4B,CACxCN,SAAS,CAAC,oCAAoC,CAC9CvE,KAAK,CAAEjE,aAAa,CAACY,gBAAiB,CACtC+H,QAAQ,CAAEvE,qBAAsB,CACjC,CAAC,EACF,CACH,EACD,CACH,cACDlG,IAAA,UAAOsK,SAAS,CAAC,0DAA0D,CAAAC,QAAA,CAAC,0BAAwB,CAAO,CAAC,cAC5GvK,IAAA,aACE8F,IAAI,CAAC,oBAAoB,CACzB8E,WAAW,CAAC,yBAAyB,CACrCC,IAAI,CAAC,GAAG,CACRP,SAAS,CAAC,kDAAkD,CAC5DvE,KAAK,CAAEjE,aAAa,CAACS,kBAAmB,CACxCkI,QAAQ,CAAEvE,qBAAsB,CACvB,CAAC,EACT,CAAC,cACNlG,IAAA,WACEwK,OAAO,CAAEvD,qBAAsB,CAC/BqD,SAAS,CAAC,mFAAmF,CAAAC,QAAA,CAC9F,gCAED,CAAQ,CAAC,EACN,CACN,CAEAtJ,cAAc,GAAK,WAAW,eAC7Bf,KAAA,QAAKoK,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/CvK,IAAA,OAAIsK,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,wBAAsB,CAAI,CAAC,cACtErK,KAAA,QAAKoK,SAAS,CAAC,wDAAwD,CAAAC,QAAA,eACrEvK,IAAA,WACEwK,OAAO,CAAEzB,oBAAqB,CAC9BuB,SAAS,CAAC,iFAAiF,CAAAC,QAAA,CAC5F,yBAED,CAAQ,CAAC,cACTrK,KAAA,QAAKoK,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1CvK,IAAA,UAAOsK,SAAS,CAAC,iCAAiC,CAAAC,QAAA,CAAC,QAAM,CAAO,CAAC,cACjEvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXJ,KAAK,CAAEhD,eAAgB,CACvB0H,QAAQ,CAAG5E,CAAC,EAAK7C,kBAAkB,CAAC6C,CAAC,CAACG,MAAM,CAACD,KAAK,CAAE,CACpDuE,SAAS,CAAC,8EAA8E,CACzF,CAAC,cACFtK,IAAA,UAAOsK,SAAS,CAAC,iCAAiC,CAAAC,QAAA,CAAC,QAAM,CAAO,CAAC,cACjEvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXJ,KAAK,CAAE9C,aAAc,CACrBwH,QAAQ,CAAG5E,CAAC,EAAK3C,gBAAgB,CAAC2C,CAAC,CAACG,MAAM,CAACD,KAAK,CAAE,CAClDuE,SAAS,CAAC,8EAA8E,CACzF,CAAC,EACC,CAAC,cACNpK,KAAA,QAAAqK,QAAA,eACEvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMtB,mBAAmB,CAAC,KAAK,CAAE,CAC1CoB,SAAS,CAAC,wFAAwF,CAAAC,QAAA,CACnG,gBAED,CAAQ,CAAC,cACTvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMtB,mBAAmB,CAAC,KAAK,CAAE,CAC1CoB,SAAS,CAAC,+EAA+E,CAAAC,QAAA,CAC1F,gBAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,cACNvK,IAAA,QAAKsK,SAAS,CAAC,sCAAsC,CAAAC,QAAA,cACnDrK,KAAA,UAAO8K,GAAG,CAAElI,eAAgB,CAACwH,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAClEvK,IAAA,UAAOsK,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cACvCrK,KAAA,OAAAqK,QAAA,eACEvK,IAAA,OAAIsK,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAAC,WAAS,CAAI,CAAC,cAC9EvK,IAAA,OAAIsK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,WAAS,CAAI,CAAC,cAChEvK,IAAA,OAAIsK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,aAAW,CAAI,CAAC,cAClEvK,IAAA,OAAIsK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,cAAY,CAAI,CAAC,cACnEvK,IAAA,OAAIsK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,eAAa,CAAI,CAAC,cACpEvK,IAAA,OAAIsK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,kBAAgB,CAAI,CAAC,cACvEvK,IAAA,OAAIsK,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAAC,UAAQ,CAAI,CAAC,EAC3E,CAAC,CACA,CAAC,cACRvK,IAAA,UAAOsK,SAAS,CAAC,0BAA0B,CAAAC,QAAA,CACxCN,2BAA2B,CAACzE,GAAG,CAAEvB,MAAM,eACtC/D,KAAA,OAAoBoK,SAAS,CAAC,qCAAqC,CAAAC,QAAA,eACjEvK,IAAA,OAAIsK,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEtG,MAAM,CAACI,EAAE,CAAK,CAAC,cAC1CrE,IAAA,OAAIsK,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEtG,MAAM,CAACK,QAAQ,CAAK,CAAC,cAChDtE,IAAA,OAAIsK,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEtG,MAAM,CAACM,UAAU,CAAK,CAAC,cAClDvE,IAAA,OAAIsK,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEtG,MAAM,CAACW,WAAW,CAAK,CAAC,cACnD5E,IAAA,OAAIsK,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEtG,MAAM,CAACzC,aAAa,CAAK,CAAC,cACrDxB,IAAA,OAAIsK,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEtG,MAAM,CAACO,eAAe,CAAK,CAAC,cACvDtE,KAAA,OAAIoK,SAAS,CAAC,WAAW,CAAAC,QAAA,eACvBvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAM9B,yBAAyB,CAACzE,MAAM,CAAE,CACjDqG,SAAS,CAAC,sEAAsE,CAAAC,QAAA,CACjF,QAED,CAAQ,CAAC,cACTvK,IAAA,WACEwK,OAAO,CAAEA,CAAA,GAAMpC,yBAAyB,CAACnE,MAAM,CAACI,EAAE,CAAE,CACpDiG,SAAS,CAAC,+DAA+D,CAAAC,QAAA,CAC1E,UAED,CAAQ,CAAC,EACP,CAAC,GApBEtG,MAAM,CAACI,EAqBZ,CACL,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,CAGLzB,aAAa,eACZ1C,KAAA,QAAKoK,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eAChErK,KAAA,OAAIoK,SAAS,CAAC,0CAA0C,CAAAC,QAAA,EAAC,gCAA2B,CAAC3H,aAAa,CAACyB,EAAE,EAAK,CAAC,cAC3GnE,KAAA,QAAKoK,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDrK,KAAA,QAAAqK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,cAAY,CAAO,CAAC,cAClFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,YAAY,CACjBwE,SAAS,CAAC,mEAAmE,CAC7EvE,KAAK,CAAEnD,aAAa,CAAC2B,UAAW,CAChC0G,QAAQ,MACT,CAAC,EACC,CAAC,cACN/K,KAAA,QAAAqK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,eAAa,CAAO,CAAC,cACnFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,aAAa,CAClBwE,SAAS,CAAC,qFAAqF,CAC/FvE,KAAK,CAAEnD,aAAa,CAACgC,WAAY,CACjC6F,QAAQ,CAAE9B,0BAA2B,CACtC,CAAC,EACC,CAAC,cACNzI,KAAA,QAAAqK,QAAA,eACEvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,mBAAiB,CAAO,CAAC,cACvFvK,IAAA,UACEmG,IAAI,CAAC,MAAM,CACXL,IAAI,CAAC,iBAAiB,CACtBwE,SAAS,CAAC,qFAAqF,CAC/FvE,KAAK,CAAEnD,aAAa,CAAC4B,eAAgB,CACrCiG,QAAQ,CAAE9B,0BAA2B,CACtC,CAAC,EACC,CAAC,cACNzI,KAAA,QAAKoK,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BvK,IAAA,UAAOsK,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACpFvK,IAAA,aACE8F,IAAI,CAAC,eAAe,CACpB+E,IAAI,CAAC,GAAG,CACRP,SAAS,CAAC,qFAAqF,CAC/FvE,KAAK,CAAEnD,aAAa,CAACpB,aAAc,CACnCiJ,QAAQ,CAAE9B,0BAA2B,CAC5B,CAAC,EACT,CAAC,EACH,CAAC,cACNzI,KAAA,QAAKoK,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eAC9CvK,IAAA,WACEwK,OAAO,CAAE3B,uBAAwB,CACjCyB,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CACxG,iBAED,CAAQ,CAAC,cACTvK,IAAA,WACEwK,OAAO,CAAE1B,0BAA2B,CACpCwB,SAAS,CAAC,2FAA2F,CAAAC,QAAA,CACtG,qBAED,CAAQ,CAAC,EACN,CAAC,EACH,CACN,EACE,CACN,cAGDrK,KAAA,QAAKoK,SAAS,CAAC,oCAAoC,CAAAC,QAAA,eACjDvK,IAAA,OAAIsK,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,gDAAwC,CAAI,CAAC,cACxFvK,IAAA,QAAKsK,SAAS,CAAC,iBAAiB,CAAAC,QAAA,cAC9BrK,KAAA,UAAOoK,SAAS,CAAC,oCAAoC,CAAAC,QAAA,eACnDvK,IAAA,UAAOsK,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC5BrK,KAAA,OAAAqK,QAAA,eACEvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,SAAO,CAAI,CAAC,cAC7CvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,QAAM,CAAI,CAAC,cAC5CvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,2BAAsB,CAAI,CAAC,cAC5DvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,sBAAoB,CAAI,CAAC,cAC1DvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,mBAAc,CAAI,CAAC,cACpDvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,UAAQ,CAAI,CAAC,EAC5C,CAAC,CACA,CAAC,cACRvK,IAAA,UAAAuK,QAAA,CACGd,YAAY,CAACjE,GAAG,CAACkF,IAAI,EAAI,CACxB,KAAM,CAAAQ,aAAa,CAAG/H,qBAAqB,CAACuH,IAAI,CAACxI,kBAAkB,CAAC,CACpE,KAAM,CAAAiJ,SAAS,CAAGD,aAAa,CAAG,CAAC,CAEnC,mBACEhL,KAAA,OAAAqK,QAAA,eACEvK,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAEG,IAAI,CAACrG,EAAE,CAAK,CAAC,cAC/CrE,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAEG,IAAI,CAAC5E,IAAI,CAAK,CAAC,cACjD9F,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAEG,IAAI,CAACX,oBAAoB,EAAI,KAAK,CAAK,CAAC,cAC1E/J,IAAA,OAAIsK,SAAS,qBAAA3D,MAAA,CAAsBwE,SAAS,CAAG,wBAAwB,CAAG,EAAE,CAAG,CAAAZ,QAAA,CAC5EG,IAAI,CAACxI,kBAAkB,EAAI,KAAK,CAC/B,CAAC,cACLlC,IAAA,OAAIsK,SAAS,qBAAA3D,MAAA,CAAsBwE,SAAS,CAAG,wBAAwB,CAAG,EAAE,CAAG,CAAAZ,QAAA,CAC5EhH,KAAK,CAAC2H,aAAa,CAAC,CAAG,KAAK,CAAIC,SAAS,mBAAAxE,MAAA,CAAkBhD,IAAI,CAACyH,GAAG,CAACF,aAAa,CAAC,aAAUA,aAAc,CACzG,CAAC,cACLlL,IAAA,OAAIsK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,cAC9BvK,IAAA,WACEsK,SAAS,CAAC,8BAA8B,CACxCE,OAAO,CAAEA,CAAA,GAAM7J,mBAAmB,CAAC+J,IAAI,CAACrG,EAAE,CAAE,CAAAkG,QAAA,CAC7C,UAED,CAAQ,CAAC,CACP,CAAC,GAjBEG,IAAI,CAACrG,EAkBV,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,EACH,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAA/D,uBAAuB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}